<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Private Pilot Oral Exam Prep - Interactive Study</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Montserrat:wght@700;800;900&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e3a8a 100%);
            min-height: 100vh;
            color: #fff;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px 20px 40px 20px;
        }
        
        /* Landing Screen */
        .landing-screen {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 40px 20px;
        }
        
        .welcome-card {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border-radius: 24px;
            padding: 60px 50px;
            border: 1px solid rgba(255,255,255,0.2);
            max-width: 600px;
            animation: fadeInUp 0.8s ease;
        }
        
        .welcome-badge {
            display: inline-block;
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: 700;
            letter-spacing: 1px;
            text-transform: uppercase;
            margin-bottom: 20px;
        }
        
        .welcome-title {
            font-family: 'Montserrat', sans-serif;
            font-size: 42px;
            font-weight: 800;
            color: #ffffff;
            margin-bottom: 12px;
            line-height: 1.2;
        }
        
        .welcome-subtitle {
            font-size: 18px;
            color: #cbd5e1;
            margin-bottom: 12px;
            font-weight: 600;
        }
        
        .welcome-description {
            font-size: 15px;
            color: #94a3b8;
            line-height: 1.6;
            margin-bottom: 30px;
        }
        
        .welcome-description strong {
            color: #cbd5e1;
            font-weight: 600;
        }
        
        .welcome-info {
            margin-bottom: 16px;
            margin-top: 32px;
            text-align: left;
        }
        
        .upgrade-hint {
            margin-top: 24px;
            padding-top: 24px;
            border-top: 1px solid rgba(255,255,255,0.1);
            color: #94a3b8;
            font-size: 13px;
        }
        
        .start-button {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
            border: none;
            padding: 20px 50px;
            border-radius: 14px;
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Inter', sans-serif;
            box-shadow: 0 8px 30px rgba(59,130,246,0.4);
        }
        
        .start-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 40px rgba(59,130,246,0.5);
        }
        
        .features-list {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            margin-top: 40px;
            text-align: left;
        }
        
        .feature-item {
            background: rgba(255,255,255,0.05);
            padding: 16px;
            border-radius: 10px;
            font-size: 14px;
            color: #cbd5e1;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .feature-item::before {
            content: 'âœ“';
            color: #10b981;
            font-weight: bold;
            font-size: 18px;
            background: rgba(16,185,129,0.2);
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            flex-shrink: 0;
        }
        
        /* Onboarding Modal */
        .onboarding-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(15, 23, 42, 0.95);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            animation: fadeIn 0.3s ease;
        }
        
        .onboarding-overlay.hidden {
            display: none;
        }
        
        .onboarding-modal {
            background: linear-gradient(135deg, rgba(30, 58, 138, 0.4) 0%, rgba(30, 64, 175, 0.4) 100%);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 24px;
            padding: 48px;
            max-width: 600px;
            width: 90%;
            animation: fadeInUp 0.5s ease;
            text-align: center;
        }
        
        .onboarding-icon {
            font-size: 64px;
            margin-bottom: 16px;
        }
        
        .onboarding-title {
            font-family: 'Montserrat', sans-serif;
            font-size: 32px;
            font-weight: 800;
            color: #ffffff;
            margin-bottom: 32px;
        }
        
        .onboarding-steps {
            text-align: left;
            margin-bottom: 32px;
        }
        
        .onboarding-step {
            display: flex;
            gap: 20px;
            margin-bottom: 24px;
            align-items: flex-start;
        }
        
        .step-number {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            font-size: 18px;
            flex-shrink: 0;
        }
        
        .step-content h3 {
            font-size: 18px;
            font-weight: 700;
            color: #ffffff;
            margin-bottom: 8px;
        }
        
        .step-content p {
            font-size: 14px;
            color: #cbd5e1;
            line-height: 1.6;
        }
        
        .step-content strong {
            color: #ffffff;
        }
        
        .onboarding-btn {
            width: 100%;
            padding: 18px 40px;
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
            border: none;
            border-radius: 14px;
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Inter', sans-serif;
            box-shadow: 0 8px 30px rgba(59,130,246,0.4);
        }
        
        .onboarding-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 40px rgba(59,130,246,0.5);
        }
        
        .onboarding-skip {
            margin-top: 16px;
            color: #94a3b8;
            font-size: 13px;
        }
        
        /* Upgrade Modal */
        .upgrade-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(15, 23, 42, 0.95);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1001;
            animation: fadeIn 0.3s ease;
        }
        
        .upgrade-overlay.hidden {
            display: none;
        }
        
        .upgrade-modal {
            background: linear-gradient(135deg, rgba(30, 58, 138, 0.4) 0%, rgba(30, 64, 175, 0.4) 100%);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 24px;
            padding: 48px;
            max-width: 500px;
            width: 90%;
            animation: fadeInUp 0.5s ease;
            text-align: center;
        }
        
        .upgrade-icon {
            font-size: 64px;
            margin-bottom: 16px;
        }
        
        .upgrade-title {
            font-family: 'Montserrat', sans-serif;
            font-size: 28px;
            font-weight: 800;
            color: #ffffff;
            margin-bottom: 12px;
        }
        
        .upgrade-subtitle {
            color: #cbd5e1;
            font-size: 16px;
            margin-bottom: 24px;
        }
        
        .upgrade-features {
            background: rgba(255,255,255,0.1);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 24px;
            text-align: left;
        }
        
        .upgrade-feature {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
            color: #cbd5e1;
            font-size: 14px;
        }
        
        .upgrade-feature:last-child {
            margin-bottom: 0;
        }
        
        .upgrade-feature-icon {
            color: #10b981;
            font-size: 20px;
        }
        
        .upgrade-buttons {
            display: flex;
            gap: 12px;
        }
        
        .upgrade-btn {
            flex: 1;
            padding: 16px 24px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Inter', sans-serif;
        }
        
        .upgrade-btn.primary {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            color: white;
            box-shadow: 0 8px 30px rgba(245,158,11,0.4);
        }
        
        .upgrade-btn.primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 40px rgba(245,158,11,0.5);
        }
        
        .upgrade-btn.secondary {
            background: rgba(255,255,255,0.1);
            color: white;
            border: 1px solid rgba(255,255,255,0.3);
        }
        
        .upgrade-btn.secondary:hover {
            background: rgba(255,255,255,0.15);
        }
        
        /* Reset Confirmation Modal */
        .reset-confirmation-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(15, 23, 42, 0.95);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1001;
            animation: fadeIn 0.3s ease;
        }
        
        .reset-confirmation-overlay.hidden {
            display: none;
        }
        
        .reset-confirmation-modal {
            background: linear-gradient(135deg, rgba(30, 58, 138, 0.4) 0%, rgba(30, 64, 175, 0.4) 100%);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 24px;
            padding: 48px;
            max-width: 500px;
            width: 90%;
            animation: fadeInUp 0.5s ease;
            text-align: center;
        }
        
        .reset-icon {
            font-size: 64px;
            margin-bottom: 16px;
        }
        
        .reset-title {
            font-family: 'Montserrat', sans-serif;
            font-size: 28px;
            font-weight: 800;
            color: #ffffff;
            margin-bottom: 12px;
        }
        
        .reset-subtitle {
            color: #cbd5e1;
            font-size: 16px;
            margin-bottom: 24px;
            line-height: 1.6;
        }
        
        .reset-warning {
            background: rgba(239,68,68,0.2);
            border: 2px solid rgba(239,68,68,0.4);
            border-radius: 12px;
            padding: 16px;
            color: #fca5a5;
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 24px;
        }
        
        .reset-buttons {
            display: flex;
            gap: 12px;
        }
        
        .reset-btn {
            flex: 1;
            padding: 16px 24px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Inter', sans-serif;
        }
        
        .reset-btn.primary {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: white;
            box-shadow: 0 8px 30px rgba(239,68,68,0.4);
        }
        
        .reset-btn.primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 40px rgba(239,68,68,0.5);
        }
        
        .reset-btn.secondary {
            background: rgba(255,255,255,0.1);
            color: white;
            border: 1px solid rgba(255,255,255,0.3);
        }
        
        .reset-btn.secondary:hover {
            background: rgba(255,255,255,0.15);
        }
        
        /* Mock Checkride Screens */
        .mock-briefing {
            display: none;
        }
        
        .mock-briefing.active {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 60vh;
        }
        
        .briefing-card {
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            padding: 48px;
            max-width: 700px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        .briefing-icon {
            font-size: 72px;
            text-align: center;
            margin-bottom: 16px;
        }
        
        .briefing-title {
            font-family: 'Montserrat', sans-serif;
            font-size: 32px;
            font-weight: 800;
            color: #1e3a8a;
            text-align: center;
            margin-bottom: 8px;
        }
        
        .briefing-subtitle {
            text-align: center;
            color: #64748b;
            font-size: 16px;
            margin-bottom: 32px;
        }
        
        .briefing-rules h3 {
            color: #1e293b;
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 16px;
        }
        
        .rule-item {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            margin-bottom: 12px;
            color: #334155;
            font-size: 15px;
            line-height: 1.6;
        }
        
        .rule-icon {
            font-size: 20px;
            flex-shrink: 0;
        }
        
        .briefing-warning {
            background: #fef3c7;
            border: 2px solid #fde68a;
            border-radius: 12px;
            padding: 16px;
            color: #92400e;
            font-size: 14px;
            text-align: center;
            margin: 24px 0;
        }
        
        .briefing-info {
            background: #dbeafe;
            border: 2px solid #93c5fd;
            border-radius: 12px;
            padding: 16px;
            color: #1e40af;
            font-size: 14px;
            text-align: center;
            margin: 24px 0;
        }
        
        .briefing-buttons {
            display: flex;
            gap: 16px;
        }
        
        .briefing-btn {
            flex: 1;
            padding: 18px 32px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Inter', sans-serif;
        }
        
        .briefing-btn.primary {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: white;
            box-shadow: 0 8px 30px rgba(239,68,68,0.4);
        }
        
        .briefing-btn.primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 40px rgba(239,68,68,0.5);
        }
        
        .briefing-btn.secondary {
            background: rgba(59,130,246,0.1);
            color: #1e40af;
            border: 2px solid rgba(59,130,246,0.3);
        }
        
        .briefing-btn.secondary:hover {
            background: rgba(59,130,246,0.15);
        }
        
        /* Mock Exam Screen */
        .mock-exam-screen {
            display: none;
        }
        
        .mock-exam-screen.active {
            display: block;
        }
        
        .mock-back-btn {
            background: rgba(255,255,255,0.2);
            backdrop-filter: blur(10px);
            color: white;
            border: 1px solid rgba(255,255,255,0.3);
            padding: 12px 24px;
            border-radius: 10px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            font-family: 'Inter', sans-serif;
            position: relative;
            z-index: 10;
        }
        
        .mock-back-btn:hover {
            background: rgba(255,255,255,0.3);
        }
        
        .mock-timer {
            background: rgba(239,68,68,0.15);
            border: 2px solid rgba(239,68,68,0.3);
            border-radius: 16px;
            padding: 20px;
            text-align: center;
        }
        
        .timer-label {
            display: block;
            font-size: 12px;
            font-weight: 700;
            color: #dc2626;
            letter-spacing: 1px;
            margin-bottom: 8px;
        }
        
        .timer-display {
            font-family: 'Montserrat', sans-serif;
            font-size: 48px;
            font-weight: 800;
            color: #ef4444;
        }
        
        .mock-progress-bar {
            background: rgba(255,255,255,0.2);
            border-radius: 10px;
            height: 10px;
            margin-bottom: 24px;
            overflow: hidden;
        }
        
        .mock-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #ef4444 0%, #dc2626 100%);
            transition: width 0.5s ease;
            border-radius: 10px;
        }
        
        .mock-question-card {
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        .mock-question-header {
            text-align: center;
            margin-bottom: 24px;
            padding-bottom: 20px;
            border-bottom: 2px solid #e2e8f0;
        }
        
        .mock-question-number {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: white;
            padding: 10px 24px;
            border-radius: 10px;
            font-weight: 800;
            font-size: 16px;
            display: inline-block;
        }
        
        .mock-question-text {
            color: #1e293b;
            font-size: 22px;
            line-height: 1.6;
            font-weight: 600;
            margin-bottom: 30px;
            text-align: center;
        }
        
        .mock-thinking-space {
            background: #f8fafc;
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 30px;
            border: 2px dashed #cbd5e1;
        }
        
        .mock-reveal-btn {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Inter', sans-serif;
            box-shadow: 0 4px 20px rgba(59,130,246,0.4);
        }
        
        .mock-reveal-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 25px rgba(59,130,246,0.5);
        }
        
        .mock-answer-section {
            margin-top: 24px;
            padding-top: 24px;
            border-top: 2px solid #e2e8f0;
        }
        
        .mock-answer-section.hidden {
            display: none;
        }
        
        .mock-rating-buttons {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
        }
        
        .mock-rating-btn {
            padding: 24px 20px;
            border: 3px solid;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Inter', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
        }
        
        .mock-rating-btn .rating-btn-icon {
            font-size: 32px;
        }
        
        .mock-rating-btn.wrong {
            background: #fef2f2;
            border-color: #fecaca;
            color: #dc2626;
        }
        
        .mock-rating-btn.wrong:hover {
            background: #fee2e2;
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(220,38,38,0.2);
        }
        
        .mock-rating-btn.unsure {
            background: #fffbeb;
            border-color: #fde68a;
            color: #d97706;
        }
        
        .mock-rating-btn.unsure:hover {
            background: #fef3c7;
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(217,119,6,0.2);
        }
        
        .mock-rating-btn.correct {
            background: #f0fdf4;
            border-color: #bbf7d0;
            color: #16a34a;
        }
        
        .mock-rating-btn.correct:hover {
            background: #dcfce7;
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(22,163,74,0.2);
        }
        
        /* Mock Results */
        .mock-results {
            display: none;
        }
        
        .mock-results.active {
            display: block;
        }
        
        /* Performance Insights */
        .insights-screen {
            display: none;
        }
        
        .insights-screen.active {
            display: block;
        }
        
        /* App Screen (hidden initially) */
        .app-screen {
            display: none;
        }
        
        .app-screen.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        .landing-screen.hidden {
            display: none;
        }
        
        /* Header */
        .header {
            text-align: center;
            margin-bottom: 24px;
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 20px 32px;
            border: 1px solid rgba(255,255,255,0.2);
        }
        
        .logo {
            font-family: 'Montserrat', sans-serif;
            font-size: 28px;
            font-weight: 800;
            color: #ffffff;
            margin-bottom: 4px;
            line-height: 1.2;
        }
        
        .tagline {
            font-size: 11px;
            color: #cbd5e1;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 1.5px;
        }
        
        /* Stats Dashboard */
        .stats-dashboard {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid rgba(255,255,255,0.2);
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 16px;
            text-align: center;
        }
        
        .stat-box {
            background: rgba(255,255,255,0.08);
            padding: 16px 12px;
            border-radius: 16px;
            border: 1px solid rgba(255,255,255,0.15);
            transition: all 0.3s ease;
        }
        
        .stat-box:hover {
            background: rgba(255,255,255,0.12);
            transform: translateY(-2px);
        }
        
        .stat-number {
            font-size: 40px;
            font-weight: 800;
            display: block;
            margin-bottom: 6px;
            font-family: 'Montserrat', sans-serif;
        }
        
        .stat-number.green { 
            color: #10b981;
            text-shadow: 0 0 20px rgba(16,185,129,0.3);
        }
        .stat-number.yellow { 
            color: #f59e0b;
            text-shadow: 0 0 20px rgba(245,158,11,0.3);
        }
        .stat-number.red { 
            color: #ef4444;
            text-shadow: 0 0 20px rgba(239,68,68,0.3);
        }
        .stat-number.blue { 
            color: #60a5fa;
            text-shadow: 0 0 20px rgba(96,165,250,0.3);
        }
        
        .stat-label {
            font-size: 11px;
            color: #cbd5e1;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: 600;
        }
        
        /* Mode Selection */
        .mode-selection {
            display: flex;
            flex-direction: column;
            gap: 24px;
            margin-bottom: 40px;
        }
        
        /* Hero card - Mock Checkride */
        .hero-mode-card {
            background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
            border-radius: 20px;
            padding: 48px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: 3px solid rgba(255,255,255,0.2);
            position: relative;
            box-shadow: 0 20px 60px rgba(59,130,246,0.4);
            overflow: hidden;
        }
        
        .hero-mode-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            transition: left 0.5s;
        }
        
        .hero-mode-card:hover::before {
            left: 100%;
        }
        
        .hero-mode-card:hover {
            transform: translateY(-6px) scale(1.01);
            box-shadow: 0 25px 70px rgba(59,130,246,0.5);
            border-color: rgba(255,255,255,0.4);
        }
        
        .hero-mode-card .mode-icon {
            font-size: 64px;
            margin-bottom: 20px;
        }
        
        .hero-mode-card .mode-title {
            font-size: 32px;
            font-weight: 900;
            color: #ffffff;
            margin-bottom: 12px;
            font-family: 'Montserrat', sans-serif;
        }
        
        .hero-mode-card .mode-desc {
            font-size: 16px;
            color: rgba(255,255,255,0.9);
            line-height: 1.7;
            max-width: 700px;
        }
        
        .hero-badge {
            position: absolute;
            top: 24px;
            right: 24px;
            background: rgba(255,255,255,0.2);
            backdrop-filter: blur(10px);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 700;
            letter-spacing: 1px;
            text-transform: uppercase;
            border: 2px solid rgba(255,255,255,0.3);
            animation: pulse 2s ease-in-out infinite;
        }
        
        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
                opacity: 1;
            }
            50% {
                transform: scale(1.05);
                opacity: 0.9;
            }
        }
        
        /* EPIC Pass celebration animation - Runescape level up style */
        @keyframes epicCelebrate {
            0% {
                transform: scale(0) rotate(-180deg);
                opacity: 0;
            }
            30% {
                transform: scale(1.3) rotate(10deg);
            }
            50% {
                transform: scale(0.9) rotate(-5deg);
            }
            70% {
                transform: scale(1.1) rotate(3deg);
            }
            100% {
                transform: scale(1) rotate(0deg);
                opacity: 1;
            }
        }
        
        @keyframes megaBounce {
            0%, 100% {
                transform: translateY(0) scale(1);
            }
            10% {
                transform: translateY(-30px) scale(1.1);
            }
            20% {
                transform: translateY(0) scale(1);
            }
            30% {
                transform: translateY(-25px) scale(1.08);
            }
            40% {
                transform: translateY(0) scale(1);
            }
            50% {
                transform: translateY(-20px) scale(1.05);
            }
            60% {
                transform: translateY(0) scale(1);
            }
            70% {
                transform: translateY(-10px) scale(1.02);
            }
            80% {
                transform: translateY(0) scale(1);
            }
        }
        
        @keyframes scoreExplode {
            0% {
                transform: scale(0) rotate(-180deg);
                opacity: 0;
                filter: blur(10px);
            }
            50% {
                transform: scale(1.4) rotate(10deg);
                filter: blur(0px);
            }
            70% {
                transform: scale(0.95) rotate(-5deg);
            }
            85% {
                transform: scale(1.05) rotate(2deg);
            }
            100% {
                transform: scale(1) rotate(0deg);
                opacity: 1;
                filter: blur(0px);
            }
        }
        
        @keyframes glow {
            0%, 100% {
                box-shadow: 0 0 20px rgba(16, 185, 129, 0.3),
                            0 0 40px rgba(16, 185, 129, 0.2),
                            0 0 60px rgba(16, 185, 129, 0.1);
            }
            50% {
                box-shadow: 0 0 30px rgba(16, 185, 129, 0.5),
                            0 0 60px rgba(16, 185, 129, 0.3),
                            0 0 90px rgba(16, 185, 129, 0.2);
            }
        }
        
        @keyframes shimmer {
            0% {
                background-position: -1000px 0;
            }
            100% {
                background-position: 1000px 0;
            }
        }
        
        @keyframes confetti {
            0% {
                transform: translateY(0) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }
        
        @keyframes bounce {
            0%, 100% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-20px);
            }
        }
        
        /* Fail shake animation */
        @keyframes shake {
            0%, 100% {
                transform: translateX(0);
            }
            25% {
                transform: translateX(-10px);
            }
            75% {
                transform: translateX(10px);
            }
        }
        
        @keyframes fadeInSlow {
            0% {
                opacity: 0;
                transform: translateY(20px);
            }
            100% {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .epic-celebrate {
            animation: epicCelebrate 1s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }
        
        .mega-bounce {
            animation: megaBounce 2s ease-in-out;
        }
        
        .score-explode {
            animation: scoreExplode 1.2s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }
        
        .glow-effect {
            animation: glow 2s ease-in-out infinite;
        }
        
        .celebrate-animation {
            animation: celebrate 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }
        
        .bounce-animation {
            animation: bounce 0.5s ease-in-out 3;
        }
        
        .shake-animation {
            animation: shake 0.5s ease-in-out;
        }
        
        .fade-in-slow {
            animation: fadeInSlow 0.8s ease;
        }
        
        /* Standard modes grid */
        .modes-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }
        
        .mode-card {
            background: rgba(255,255,255,0.95);
            border-radius: 16px;
            padding: 32px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: 3px solid transparent;
            position: relative;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        }
        
        .mode-card::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: 16px;
            background: linear-gradient(135deg, rgba(59,130,246,0.1), rgba(147,197,253,0.1));
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none;
        }
            pointer-events: none;
        }
        
        .mode-card:hover::after {
            opacity: 1;
        }
        
        .mode-card:hover {
            transform: translateY(-4px) scale(1.02);
            border-color: #3b82f6;
            box-shadow: 0 12px 40px rgba(59,130,246,0.3);
        }
        
        .mode-card.locked {
            background: rgba(255,255,255,0.5);
            cursor: not-allowed;
            opacity: 0.8;
        }
        
        .mode-card.locked:hover {
            transform: translateY(-2px);
            border-color: #f59e0b;
            box-shadow: 0 8px 30px rgba(245,158,11,0.2);
        }
        
        .premium-badge {
            position: absolute;
            top: 12px;
            right: 12px;
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: 700;
            letter-spacing: 1px;
            text-transform: uppercase;
        }
        
        .start-here-badge {
            position: absolute;
            top: 12px;
            right: 12px;
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: 800;
            letter-spacing: 0.5px;
            text-transform: uppercase;
            box-shadow: 0 4px 12px rgba(16,185,129,0.4);
            animation: gentlePulse 2.5s ease-in-out infinite;
            pointer-events: none;
        }
        
        @keyframes gentlePulse {
            0%, 100% {
                transform: scale(1);
                box-shadow: 0 4px 12px rgba(16,185,129,0.4);
            }
            50% {
                transform: scale(1.05);
                box-shadow: 0 6px 16px rgba(16,185,129,0.6);
            }
        }
        
        .mode-icon {
            font-size: 48px;
            margin-bottom: 16px;
        }
        
        .mode-title {
            font-size: 20px;
            font-weight: 800;
            color: #1e3a8a;
            margin-bottom: 8px;
        }
        
        .mode-desc {
            font-size: 14px;
            color: #64748b;
            line-height: 1.6;
        }
        
        /* Question Card */
        .question-card {
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            margin-bottom: 24px;
        }
        
        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
            padding-bottom: 20px;
            border-bottom: 2px solid #e2e8f0;
        }
        
        .question-number {
            background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%);
            color: white;
            padding: 10px 24px;
            border-radius: 10px;
            font-weight: 800;
            font-size: 18px;
        }
        
        .nav-buttons {
            display: flex;
            gap: 12px;
        }
        
        .nav-btn {
            background: rgba(59,130,246,0.1);
            border: 1px solid rgba(59,130,246,0.3);
            color: #1e40af;
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.2s;
        }
        
        .nav-btn:hover:not(:disabled) {
            background: rgba(59,130,246,0.2);
        }
        
        .nav-btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }
        
        .question-text {
            color: #1e293b;
            font-size: 20px;
            line-height: 1.6;
            font-weight: 600;
            margin-bottom: 30px;
        }
        
        .show-answer-btn {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Inter', sans-serif;
        }
        
        .show-answer-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 25px rgba(59,130,246,0.4);
        }
        
        /* Answer Section */
        .answer-section {
            margin-top: 30px;
            padding-top: 30px;
            border-top: 2px solid #e2e8f0;
        }
        
        .answer-section.hidden {
            display: none;
        }
        
        .answer-label {
            display: inline-block;
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            padding: 6px 16px;
            border-radius: 6px;
            font-size: 11px;
            font-weight: 700;
            letter-spacing: 1px;
            margin-bottom: 16px;
        }
        
        .answer-text {
            color: #334155;
            font-size: 16px;
            line-height: 1.8;
            margin-bottom: 20px;
        }
        
        .answer-text strong {
            color: #1e40af;
            font-weight: 700;
            background: rgba(59,130,246,0.08);
            padding: 2px 6px;
            border-radius: 4px;
        }
        
        .reference-tag {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);
            border: 1px solid #93c5fd;
            padding: 10px 16px;
            border-radius: 8px;
            font-size: 13px;
            font-weight: 600;
            color: #1e40af;
            text-decoration: none;
            margin-bottom: 24px;
            display: inline-block;
        }
        
        /* Rating Buttons */
        .rating-buttons {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
            margin-top: 24px;
        }
        
        .rating-btn {
            padding: 20px;
            border: 2px solid;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Inter', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
        }
        
        .rating-btn-icon {
            font-size: 28px;
        }
        
        .rating-btn.wrong {
            background: #fef2f2;
            border-color: #fecaca;
            color: #dc2626;
        }
        
        .rating-btn.wrong:hover {
            background: #fee2e2;
            transform: translateY(-2px);
        }
        
        .rating-btn.unsure {
            background: #fffbeb;
            border-color: #fde68a;
            color: #d97706;
        }
        
        .rating-btn.unsure:hover {
            background: #fef3c7;
            transform: translateY(-2px);
        }
        
        .rating-btn.correct {
            background: #f0fdf4;
            border-color: #bbf7d0;
            color: #16a34a;
        }
        
        .rating-btn.correct:hover {
            background: #dcfce7;
            transform: translateY(-2px);
        }
        
        /* Control Bar */
        .control-bar {
            display: flex;
            gap: 12px;
            justify-content: center;
            margin-bottom: 16px;
        }
        
        .control-btn {
            background: rgba(255,255,255,0.2);
            backdrop-filter: blur(10px);
            color: white;
            border: 1px solid rgba(255,255,255,0.3);
            padding: 12px 24px;
            border-radius: 10px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            font-family: 'Inter', sans-serif;
        }
        
        .control-btn:hover {
            background: rgba(255,255,255,0.3);
        }
        
        .control-btn.locked-btn {
            background: rgba(245,158,11,0.2);
            border: 1px solid rgba(245,158,11,0.4);
            color: #fbbf24;
        }
        
        .control-btn.locked-btn:hover {
            background: rgba(245,158,11,0.3);
            transform: translateY(-1px);
        }
        
        /* Main Page Reset Button */
        .main-reset-btn {
            background: rgba(239,68,68,0.1);
            color: #dc2626;
            border: 2px solid rgba(239,68,68,0.3);
            padding: 12px 24px;
            border-radius: 10px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Inter', sans-serif;
        }
        
        .main-reset-btn:hover {
            background: rgba(239,68,68,0.15);
            border-color: rgba(239,68,68,0.5);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(239,68,68,0.2);
        }
        
        /* Hidden */
        .hidden {
            display: none !important;
        }
        
        /* Progress Bar */
        .progress-container {
            background: rgba(255,255,255,0.2);
            border-radius: 10px;
            height: 8px;
            margin-bottom: 20px;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 100%;
            width: 100%;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #10b981 0%, #059669 100%);
            transition: width 0.5s ease;
            border-radius: 10px;
            width: 0%;
        }
        
        /* Animations */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        /* Mobile */
        @media (max-width: 768px) {
            .welcome-card {
                padding: 40px 30px;
            }
            
            .welcome-title {
                font-size: 36px;
            }
            
            .features-list {
                grid-template-columns: 1fr;
            }
            
            .modes-grid {
                grid-template-columns: 1fr;
            }
            
            .hero-mode-card {
                padding: 32px 24px;
            }
            
            .hero-mode-card .mode-title {
                font-size: 24px;
            }
            
            .hero-mode-card .mode-icon {
                font-size: 48px;
            }
            
            .hero-badge {
                top: 16px;
                right: 16px;
                font-size: 10px;
                padding: 6px 12px;
            }
            
            .start-here-badge {
                top: 12px;
                right: 12px;
                font-size: 10px;
                padding: 5px 12px;
            }
            
            .onboarding-modal {
                padding: 32px 24px;
                width: 95%;
            }
            
            .onboarding-title {
                font-size: 24px;
            }
            
            .onboarding-icon {
                font-size: 48px;
            }
            
            .upgrade-modal {
                padding: 32px 24px;
                width: 95%;
            }
            
            .upgrade-title {
                font-size: 24px;
            }
            
            .upgrade-buttons {
                flex-direction: column;
            }
            
            .reset-confirmation-modal {
                padding: 32px 24px;
                width: 95%;
            }
            
            .reset-title {
                font-size: 24px;
            }
            
            .reset-buttons {
                flex-direction: column;
            }
            
            .briefing-card {
                padding: 32px 24px;
            }
            
            .briefing-title {
                font-size: 24px;
            }
            
            .briefing-buttons {
                flex-direction: column;
            }
            
            .timer-display {
                font-size: 36px;
            }
            
            .mock-back-btn {
                padding: 10px 16px;
                font-size: 13px;
            }
            
            .mock-question-card {
                padding: 30px 20px;
            }
            
            .mock-question-text {
                font-size: 18px;
            }
            
            .mock-rating-buttons {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 16px;
            }
            
            .stat-number {
                font-size: 36px;
            }
            
            .question-card {
                padding: 30px 24px;
            }
            
            .rating-buttons {
                grid-template-columns: 1fr;
            }
            
            .nav-buttons {
                flex-direction: column;
            }
            
            .question-header {
                flex-direction: column;
                gap: 16px;
                align-items: flex-start;
            }
            
            .control-bar {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <!-- Landing Screen -->
    <div class="landing-screen" id="landing-screen">
        <div class="welcome-card">
            <div class="welcome-badge">PREMIUM VERSION</div>
            <div class="welcome-title">PPL Oral Exam Prep</div>
            <div class="welcome-subtitle">Master Your Checkride with Real DPE Scenarios</div>
            <div class="welcome-description">
                Practice with <strong>100 realistic scenario-based questions</strong> that mirror actual checkride situations. Each question includes detailed model answers, FAA references, and intelligent progress tracking.
            </div>
            
            <button type="button" class="start-button" onclick="startApp()">
                Start Studying â†’
            </button>
            
            <div class="welcome-info">
                <p style="margin-bottom: 12px; font-weight: 600; color: #cbd5e1;">What's Included:</p>
            </div>
            
            <div class="features-list">
                <div class="feature-item">100 DPE-Style Questions</div>
                <div class="feature-item">Study & Random Modes</div>
                <div class="feature-item">Track Your Weak Areas</div>
                <div class="feature-item">Linked FAA References</div>
            </div>
        </div>
    </div>
    
    <!-- Upgrade Modal (hidden initially) -->
    <div class="upgrade-overlay hidden" id="upgrade-overlay">
        <div class="upgrade-modal">
            <div class="upgrade-icon">ðŸ”’</div>
            <h2 class="upgrade-title" id="upgrade-title">Premium Feature</h2>
            <p class="upgrade-subtitle" id="upgrade-subtitle">Upgrade to unlock this feature</p>
            
            <div class="upgrade-features">
                <div class="upgrade-feature">
                    <span class="upgrade-feature-icon">âœ“</span>
                    <span><strong>Mock Checkride Simulator</strong> - Timed practice exam</span>
                </div>
                <div class="upgrade-feature">
                    <span class="upgrade-feature-icon">âœ“</span>
                    <span>100 comprehensive checkride questions</span>
                </div>
                <div class="upgrade-feature">
                    <span class="upgrade-feature-icon">âœ“</span>
                    <span>Review wrong answers only mode</span>
                </div>
                <div class="upgrade-feature">
                    <span class="upgrade-feature-icon">âœ“</span>
                    <span>Performance insights & analytics</span>
                </div>
                <div class="upgrade-feature">
                    <span class="upgrade-feature-icon">âœ“</span>
                    <span>Export progress reports</span>
                </div>
                <div class="upgrade-feature">
                    <span class="upgrade-feature-icon">âœ“</span>
                    <span>Lifetime access + updates</span>
                </div>
            </div>
            
            <div class="upgrade-buttons">
                <button type="button" class="upgrade-btn secondary" onclick="closeUpgradeModal()">Maybe Later</button>
                <button type="button" class="upgrade-btn primary" onclick="upgradeNow()">Upgrade for $37</button>
            </div>
        </div>
    </div>
    
    <!-- Reset Confirmation Modal (hidden initially) -->
    <div class="reset-confirmation-overlay hidden" id="reset-confirmation-overlay">
        <div class="reset-confirmation-modal">
            <div class="reset-icon">âš ï¸</div>
            <h2 class="reset-title">Reset All Progress?</h2>
            <p class="reset-subtitle">This will permanently delete all your study progress, ratings, and statistics.</p>
            
            <div class="reset-warning">
                This action cannot be undone.
            </div>
            
            <div class="reset-buttons">
                <button type="button" class="reset-btn secondary" onclick="closeResetConfirmation()">Cancel</button>
                <button type="button" class="reset-btn primary" onclick="confirmReset()">Yes, Reset Everything</button>
            </div>
        </div>
    </div>
    
    <!-- Exit Mock Checkride Confirmation Modal -->
    <div class="reset-confirmation-overlay hidden" id="exit-mock-overlay">
        <div class="reset-confirmation-modal">
            <div class="reset-icon">âš ï¸</div>
            <h2 class="reset-title">Exit Mock Checkride?</h2>
            <p class="reset-subtitle">Your progress in this mock checkride will be lost.</p>
            
            <div class="reset-warning">
                The timer will stop and you'll return to the main menu.
            </div>
            
            <div class="reset-buttons">
                <button type="button" class="reset-btn secondary" onclick="closeExitConfirmation()">Stay in Exam</button>
                <button type="button" class="reset-btn primary" onclick="confirmExitMock()">Yes, Exit</button>
            </div>
        </div>
    </div>
    
    <!-- No Wrong Answers Modal -->
    <div class="reset-confirmation-overlay hidden" id="no-wrong-answers-overlay">
        <div class="reset-confirmation-modal">
            <div class="reset-icon">âœ…</div>
            <h2 class="reset-title">Great Job!</h2>
            <p class="reset-subtitle">You don't have any questions marked as "Need Practice".</p>
            
            <div class="reset-warning" style="background: rgba(16,185,129,0.2); border: 2px solid #10b981; color: #ffffff; font-weight: 700;">
                Try Study or Random mode to continue learning.
            </div>
            
            <div class="reset-buttons">
                <button type="button" class="reset-btn primary" onclick="closeNoWrongAnswersModal()">Got It</button>
            </div>
        </div>
    </div>
    
    <!-- Onboarding Modal (hidden initially) -->
    <div class="onboarding-overlay hidden" id="onboarding-overlay">
        <div class="onboarding-modal">
            <div class="onboarding-icon">âœˆï¸</div>
            <h2 class="onboarding-title">How It Works</h2>
            <div class="onboarding-steps">
                <div class="onboarding-step">
                    <div class="step-number">1</div>
                    <div class="step-content">
                        <h3>Choose Your Mode</h3>
                        <p><strong>Study Mode:</strong> Go through questions in order to learn<br>
                        <strong>Random Mode:</strong> Test yourself with shuffled questions</p>
                    </div>
                </div>
                <div class="onboarding-step">
                    <div class="step-number">2</div>
                    <div class="step-content">
                        <h3>Read & Reflect</h3>
                        <p>Think about your answer before revealing the model response</p>
                    </div>
                </div>
                <div class="onboarding-step">
                    <div class="step-number">3</div>
                    <div class="step-content">
                        <h3>Rate Honestly</h3>
                        <p><strong>Mastered:</strong> You knew it cold<br>
                        <strong>Review:</strong> Partially correct, needs more study<br>
                        <strong>Need Practice:</strong> Got it wrong, need to review</p>
                    </div>
                </div>
            </div>
            <button type="button" class="onboarding-btn" onclick="closeOnboarding()">Got It, Let's Start! â†’</button>
            <div class="onboarding-skip">
                <small>This tutorial won't show again</small>
            </div>
        </div>
    </div>
    
    <!-- App Screen (hidden initially) -->
    <div class="app-screen" id="app-screen">
        <div class="container">
            <!-- Header -->
            <div class="header">
                <div class="logo">Private Pilot Oral Exam Prep</div>
                <div class="tagline">Interactive Study Platform</div>
            </div>
            
            <!-- Stats Dashboard -->
            <div class="stats-dashboard" id="stats-dashboard">
                <div class="stats-grid">
                    <div class="stat-box">
                        <span class="stat-number green" id="stat-correct">0</span>
                        <span class="stat-label">âœ“ Mastered</span>
                    </div>
                    <div class="stat-box">
                        <span class="stat-number yellow" id="stat-unsure">0</span>
                        <span class="stat-label">âš ï¸ Review</span>
                    </div>
                    <div class="stat-box">
                        <span class="stat-number red" id="stat-wrong">0</span>
                        <span class="stat-label">âŒ Need Practice</span>
                    </div>
                    <div class="stat-box">
                        <span class="stat-number blue" id="stat-progress">0</span>
                        <span class="stat-label">Questions Done</span>
                    </div>
                </div>
            </div>
            
            <!-- Main Page Reset Button -->
            <div id="main-reset-container" style="text-align: center; margin-bottom: 30px;">
                <button type="button" class="main-reset-btn" onclick="resetProgressMainPage(event)">
                    ðŸ”„ Reset All Progress
                </button>
            </div>
            
            <!-- Mode Selection -->
            <div class="mode-selection" id="mode-selection">
                <!-- Hero Card: Mock Checkride -->
                <div class="hero-mode-card" onclick="startMockCheckride()">
                    <div class="hero-badge">â­ Featured</div>
                    <div class="mode-icon">â±ï¸</div>
                    <div class="mode-title">Mock Checkride Simulator</div>
                    <div class="mode-desc">The ultimate test of your readiness. 30-minute timed exam with real DPE pressure. Answer questions from memory, reveal answers as you go, and get a pass/fail score. This is as close as it gets to the real thing.</div>
                </div>
                
                <!-- Standard Modes Grid -->
                <div class="modes-grid">
                    <div class="mode-card" onclick="startMode('study')">
                        <div class="start-here-badge">ðŸ‘‰ START HERE</div>
                        <div class="mode-icon">ðŸ“š</div>
                        <div class="mode-title">Study Mode</div>
                        <div class="mode-desc">Questions in order (Q1 â†’ Q100). Best for first-time learning and systematic review.</div>
                    </div>
                    
                    <div class="mode-card" onclick="startMode('random')">
                        <div class="mode-icon">ðŸŽ²</div>
                        <div class="mode-title">Random Mode</div>
                        <div class="mode-desc">Shuffled questions to test your recall. Perfect for breaking out of memorization patterns!</div>
                    </div>
                    
                    <div class="mode-card" onclick="console.log('Review card clicked'); startMode('review')">
                        <div class="mode-icon">ðŸŽ¯</div>
                        <div class="mode-title">Review Wrong Answers</div>
                        <div class="mode-desc">Focus only on questions you got wrong. Perfect for targeted practice on weak areas.</div>
                    </div>
                    
                    <div class="mode-card" onclick="showPerformanceInsights()">
                        <div class="mode-icon">ðŸ“Š</div>
                        <div class="mode-title">Performance Insights</div>
                        <div class="mode-desc">Detailed analytics on your study patterns and weak areas with personalized recommendations.</div>
                    </div>
                </div>
            </div>
            
            <!-- Control Bar (hidden initially) -->
            <div class="control-bar hidden" id="control-bar">
                <button type="button" class="control-btn" onclick="backToModes()">â† Back to Modes</button>
            </div>
            
            <!-- Progress Bar -->
            <div class="progress-container hidden" id="progress-container">
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill"></div>
                </div>
            </div>
            
            <!-- Question Card (hidden initially) -->
            <div class="question-card hidden" id="question-card">
                <div class="question-header">
                    <span class="question-number" id="q-num">Q1</span>
                    <div class="nav-buttons">
                        <button type="button" class="nav-btn" id="prev-btn" onclick="prevQuestion()">â† Previous</button>
                        <button type="button" class="nav-btn" id="next-btn" onclick="nextQuestion()">Next â†’</button>
                    </div>
                </div>
                
                <div class="question-text" id="question-text"></div>
                
                <button type="button" class="show-answer-btn" id="show-answer-btn" onclick="showAnswer()">
                    Show Answer
                </button>
                
                <div class="answer-section hidden" id="answer-section">
                    <div class="answer-label">MODEL ANSWER</div>
                    <div class="answer-text" id="answer-text"></div>
                    <a href="#" class="reference-tag" id="reference-link" target="_blank" onclick="event.stopPropagation()">
                        ðŸ“– <span id="reference-text"></span>
                    </a>
                    
                    <div class="rating-buttons">
                        <button type="button" class="rating-btn wrong" onclick="rateQuestion('wrong')">
                            <span class="rating-btn-icon">âŒ</span>
                            <span>Need Practice</span>
                        </button>
                        <button type="button" class="rating-btn unsure" onclick="rateQuestion('unsure')">
                            <span class="rating-btn-icon">âš ï¸</span>
                            <span>Review Again</span>
                        </button>
                        <button type="button" class="rating-btn correct" onclick="rateQuestion('correct')">
                            <span class="rating-btn-icon">âœ“</span>
                            <span>Mastered It!</span>
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Mock Checkride Briefing (hidden initially) -->
            <div class="mock-briefing hidden" id="mock-briefing">
                <div class="briefing-card">
                    <div class="briefing-icon">â±ï¸</div>
                    <h2 class="briefing-title">Mock Checkride - Ready?</h2>
                    <p class="briefing-subtitle">This simulates a real oral exam with a DPE</p>
                    
                    <div class="briefing-info">
                        â„¹ï¸ <strong>First Time?</strong> Study with Study Mode or Random Mode first. This is for TESTING your knowledge, not learning.
                    </div>
                    
                    <div class="briefing-rules">
                        <h3>How It Works:</h3>
                        <div class="rule-item">
                            <span class="rule-icon">1ï¸âƒ£</span>
                            <span>You'll get <strong>30 questions</strong> covering all major topics in checkride order</span>
                        </div>
                        <div class="rule-item">
                            <span class="rule-icon">2ï¸âƒ£</span>
                            <span><strong>30-minute timer</strong> starts when you begin</span>
                        </div>
                        <div class="rule-item">
                            <span class="rule-icon">3ï¸âƒ£</span>
                            <span>Read each question and <strong>think about YOUR answer</strong></span>
                        </div>
                        <div class="rule-item">
                            <span class="rule-icon">4ï¸âƒ£</span>
                            <span>Click "Reveal Answer" to see the correct answer</span>
                        </div>
                        <div class="rule-item">
                            <span class="rule-icon">5ï¸âƒ£</span>
                            <span><strong>Rate yourself honestly</strong> - compare what you thought vs. the correct answer</span>
                        </div>
                        <div class="rule-item">
                            <span class="rule-icon">6ï¸âƒ£</span>
                            <span>At the end, see your score and review all questions</span>
                        </div>
                    </div>
                    
                    <div class="briefing-warning">
                        âš ï¸ <strong>Be Honest!</strong> Rate based on what YOU actually knew, not what you learn after seeing the answer. This only helps if you're truthful with yourself.
                    </div>
                    
                    <div class="briefing-buttons">
                        <button type="button" class="briefing-btn secondary" onclick="cancelMockCheckride()">â† Back to Modes</button>
                        <button type="button" class="briefing-btn primary" onclick="beginMockCheckride()">Start Checkride â†’</button>
                    </div>
                </div>
            </div>
            
            <!-- Mock Checkride Exam Screen (hidden initially) -->
            <div class="mock-exam-screen hidden" id="mock-exam-screen">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; gap: 16px;">
                    <button type="button" class="mock-back-btn" onclick="exitMockCheckride()">
                        â† Exit Mock Checkride
                    </button>
                    <div style="display: flex; align-items: center; gap: 16px;">
                        <div class="mock-timer" id="mock-timer">
                            <span class="timer-label">TIME REMAINING:</span>
                            <span class="timer-display" id="timer-display">30:00</span>
                        </div>
                        <button type="button" onclick="endSessionNow()" style="padding: 12px 20px; background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); color: white; border: none; border-radius: 10px; font-size: 14px; font-weight: 700; cursor: pointer; font-family: 'Inter', sans-serif; box-shadow: 0 4px 15px rgba(239,68,68,0.3); white-space: nowrap;">
                            End Session
                        </button>
                    </div>
                </div>
                
                <div class="mock-progress-bar" id="mock-progress-bar">
                    <div class="mock-progress-fill" id="mock-progress-fill" style="width: 10%"></div>
                </div>
                
                <div class="mock-question-card">
                    <div class="mock-question-header">
                        <span class="mock-question-number" id="mock-q-num">Question 1 of 10</span>
                    </div>
                    
                    <div class="mock-question-text" id="mock-question-text"></div>
                    
                    <div class="mock-thinking-space" id="mock-thinking-space">
                        <p style="color: #64748b; font-size: 14px; text-align: center; margin-bottom: 8px;">
                            ðŸ’­ <strong>Think about YOUR answer first</strong>
                        </p>
                        <p style="color: #94a3b8; font-size: 12px; text-align: center; margin-bottom: 16px;">
                            What would you say to a DPE right now?
                        </p>
                        <button type="button" class="mock-reveal-btn" id="mock-reveal-btn" onclick="revealMockAnswer()">
                            Reveal Answer â†’
                        </button>
                    </div>
                    
                    <div class="mock-answer-section hidden" id="mock-answer-section">
                        <div class="answer-label">MODEL ANSWER</div>
                        <div class="answer-text" id="mock-answer-text"></div>
                        <a href="#" class="reference-tag" id="mock-reference-link" target="_blank" onclick="event.stopPropagation()">
                            ðŸ“– <span id="mock-reference-text"></span>
                        </a>
                        
                        <div style="text-align: center; margin: 24px 0 8px; color: #1e293b; font-size: 15px; font-weight: 700;">
                            How did you do?
                        </div>
                        <div style="text-align: center; margin: 0 0 16px; color: #64748b; font-size: 13px;">
                            Compare what you thought vs. the model answer above
                        </div>
                        
                        <div class="mock-rating-buttons">
                            <button type="button" class="mock-rating-btn wrong" onclick="mockRateQuestion('wrong')">
                                <span class="rating-btn-icon">âŒ</span>
                                <span>I Was Wrong</span>
                            </button>
                            <button type="button" class="mock-rating-btn unsure" onclick="mockRateQuestion('unsure')">
                                <span class="rating-btn-icon">âš ï¸</span>
                                <span>Partially Right</span>
                            </button>
                            <button type="button" class="mock-rating-btn correct" onclick="mockRateQuestion('correct')">
                                <span class="rating-btn-icon">âœ“</span>
                                <span>I Knew It!</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Mock Checkride Results (hidden initially) -->
            <div class="mock-results hidden" id="mock-results">
                <!-- Results will be inserted here by JavaScript -->
            </div>
            
            <!-- Performance Insights Screen (hidden initially) -->
            <div class="insights-screen hidden" id="insights-screen">
                <!-- Insights will be inserted here by JavaScript -->
            </div>
        </div>
    </div>
    
    <script>
        // Question Bank (100 questions)
        const questions = [
            {
                question: 'What documents must you have with you to act as pilot in command?',
                answer: 'I need three things: my <strong>pilot certificate, a current medical certificate, and a government-issued photo ID</strong>. The easy way to remember is <strong>"PPM"</strong>.<br><br>All three have to be physical documents - digital copies don\'t count. My pilot certificate stays with me, the medical has to be current for the type of flying I\'m doing (BasicMed works for most private pilot operations), and the photo ID can be my driver\'s license or passport.',
                reference: '14 CFR 61.3 & 61.23',
                link: 'https://www.ecfr.gov/current/title-14/chapter-I/subchapter-D/part-61/subpart-A/section-61.3'
            },
            {
                question: "You're planning a cross-country and notice your VOR check is 32 days old. Are you legal for IFR flight?",
                answer: "This is a trick question. If it's <strong>VFR</strong>, there's no VOR check requirement at all - I can use the VOR for navigation, but it doesn't need to be checked.<br><br>If it's <strong>IFR</strong>, then I have a problem. VOR checks are required <strong>every 30 days</strong> for IFR operations. At 32 days old, it's expired. I'd need to perform a new VOR check using VOT, ground checkpoint, airborne checkpoint, or dual VOR cross-check. I'd log the date, place, bearing error (within Â±4Â° for ground, Â±6Â° for airborne), and sign it.<br><br><strong>The key: this is only an issue for IFR flight.</strong>",
                reference: '14 CFR 91.171',
                link: 'https://www.ecfr.gov/current/title-14/chapter-I/subchapter-F/part-91/subpart-A/section-91.171'
            },
            {
                question: 'You want to rent a high-performance aircraft (more than 200 HP). Your instructor says you need an endorsement. What does the training involve and what counts as "high-performance"?',
                answer: "<strong>High-performance</strong> means an engine with more than <strong>200 horsepower</strong>. I need ground and flight training from an instructor, plus a one-time logbook endorsement.<br><br>The training covers engine operation, propeller management if it has a constant-speed prop, fuel system complexity, cooling management, and performance planning with higher speeds. Once I get the endorsement, it's good forever - no recurrency required.<br><br>If the aircraft is also <strong>complex</strong> (retractable gear, flaps, controllable prop), I need a separate complex endorsement too.",
                reference: '14 CFR 61.31(f)',
                link: 'https://www.ecfr.gov/current/title-14/chapter-I/subchapter-D/part-61/subpart-A/section-61.31'
            },
            {
                question: 'You just got your private pilot certificate. Can you fly your friend to dinner and split the cost of the rental 50/50?',
                answer: "Yes, with limits. As a private pilot, I can share expenses with passengers on a <strong>pro-rata basis</strong> - equal shares. With two people total, we each pay 50%. With three people, we each pay 33%. I have to pay at least an equal share.<br><br>I can split aircraft rental, fuel, oil, and airport fees. What I <strong>cannot</strong> do is advertise my services, hold out to the public, or get paid beyond expense sharing.<br><br><strong>The real test:</strong> Would I make this flight if my friend wasn't paying? If no, it's probably not legal.",
                reference: '14 CFR 61.113(c)',
                link: 'https://www.ecfr.gov/current/title-14/chapter-I/subchapter-D/part-61/subpart-B/section-61.113'
            },
            {
                question: "What's the difference between BasicMed and a 3rd class medical? When can you use each?",
                answer: "<strong>3rd Class Medical</strong> is issued by an FAA Aviation Medical Examiner, good for 5 years under age 40 or 2 years if 40+. It's required for commercial operations, international flights, or aircraft over 12,500 lbs.<br><br><strong>BasicMed</strong> is a medical exam from any state-licensed physician every 4 years, plus an online course every 2 years. Restrictions: aircraft under 6,000 lbs, max 5 passengers, max 18,000 feet MSL, max 250 knots, and <strong>US only</strong> - not valid internationally.<br><br>I'd use BasicMed for recreational flying in small aircraft. I need 3rd class for anything commercial or international.",
                reference: '14 CFR 61.23 & 61.113(i)',
                link: 'https://www.ecfr.gov/current/title-14/chapter-I/subchapter-D/part-61/subpart-A/section-61.23'
            },
            {
                question: 'Your annual inspection expired 3 days ago. Can you fly the plane to a maintenance facility to get it done?',
                answer: '<strong>No, I cannot fly it.</strong> An annual inspection is required every 12 calendar months for the aircraft to be airworthy. Once expired, the aircraft is not airworthy and cannot be flown - even to get the inspection done.<br><br>My only options are to have a mechanic come to wherever the plane is, or get a <strong>special flight permit</strong> (ferry permit) from the FAA. The ferry permit allows a one-time flight to a maintenance facility, but I have to apply and wait for approval.',
                reference: '14 CFR 91.409 & 14 CFR 21.197',
                link: 'https://www.ecfr.gov/current/title-14/chapter-I/subchapter-F/part-91/subpart-E/section-91.409'
            },
            {
                question: 'You\'re renting a plane and notice the airworthiness certificate isn\'t in the aircraft. The FBO says "it\'s at the shop getting laminated." Can you fly?',
                answer: '<strong>No.</strong> The airworthiness certificate must be displayed in the aircraft at all times during operation. It\'s part of the required ARROW documents.<br><br>"Getting laminated" isn\'t a valid excuse. If the original is damaged or missing, the owner needs to apply for a replacement from the FAA, but until there\'s a valid certificate <strong>in the aircraft</strong>, it\'s not legal to fly. This is different from registration, which has a 30-day grace period with the pink copy.',
                reference: '14 CFR 91.203',
                link: 'https://www.ecfr.gov/current/title-14/chapter-I/subchapter-F/part-91/subpart-A/section-91.203'
            },
            {
                question: 'The FBO rents you a plane and says "the ELT battery expired last week but we have a new one on order." Can you legally fly?',
                answer: "It depends. For VFR flight, an ELT is <strong>not required</strong> if the flight is within 50 nm of the departure airport or for training within 50 nm. But for any other flight (like a cross-country beyond 50 nm), the ELT must be operational with a current battery.<br><br>ELT batteries must be replaced when 50% of useful life has expired or after 1 cumulative hour of use.<br><br>If it's just local pattern work within 50 nm, I'm legal. If it's a cross-country, I can't fly until the battery is replaced.",
                reference: '14 CFR 91.207',
                link: 'https://www.ecfr.gov/current/title-14/chapter-I/subchapter-F/part-91/subpart-C/section-91.207'
            },
            {
                question: 'You\'re doing your preflight and notice the registration certificate shows the previous owner\'s name, but the FBO says "we just bought it, the new registration is in the mail." Can you fly it?',
                answer: "<strong>Yes, temporarily.</strong> When an aircraft changes ownership, the FAA issues a <strong>pink temporary registration</strong> that's valid for 30 days. During those 30 days, I can fly with just the pink copy displayed in the aircraft.<br><br>I'd verify the FBO has the pink temporary registration on board, it's less than 30 days old, and the old registration is still there (you need both during the transition). After 30 days, if the permanent registration hasn't arrived, the aircraft cannot be flown.",
                reference: '14 CFR 91.203',
                link: 'https://www.ecfr.gov/current/title-14/chapter-I/subchapter-F/part-91/subpart-A/section-91.203'
            },
            {
                question: "You're planning to fly a complex aircraft (retractable gear, flaps, controllable prop). What endorsement do you need and what does the training involve?",
                answer: "I need a <strong>complex aircraft endorsement</strong> - a one-time logbook endorsement. Complex means the aircraft has all three: retractable landing gear, flaps, and a controllable-pitch propeller.<br><br>The training covers gear operation (normal and emergency extension), propeller control (manifold pressure and RPM coordination), flap operation, systems knowledge, and emergency procedures like gear-up landing avoidance. Ground and flight training are required, and once I get the endorsement, it's good forever.<br><br>If the aircraft is also high-performance (over 200 HP), I need both endorsements separately.",
                reference: '14 CFR 61.31(e)',
                link: 'https://www.ecfr.gov/current/title-14/chapter-I/subchapter-D/part-61/subpart-A/section-61.31'
            },
            {
                question: 'Explain the difference between a warm front and a cold front.',
                answer: '<strong>Cold front:</strong> Cold air pushes under warm air rapidly, creating steep towering clouds, heavy precipitation, and possibly thunderstorms. Cold fronts move fast (25-30 knots) and the bad weather is intense but short-lived. After it passes, you get cooler temps, lower humidity, and gusty winds.<br><br><strong>Warm front:</strong> Warm air slides up over retreating cold air gradually, creating wide layered clouds that can extend 500+ miles ahead. You get steady, prolonged precipitation that lasts way longer. Warm fronts move slowly (10-15 knots), visibility is poor with fog and low clouds, and after passage you get warmer temps and higher humidity.<br><br><strong>For flying:</strong> Cold fronts are more dangerous short-term but easier to avoid. Warm fronts are less violent but harder to avoid because the weather area is so wide.',
                reference: 'PHAK Chapter 12',
                link: 'https://www.faa.gov/regulations_policies/handbooks_manuals/aviation/phak'
            },
            {
                question: 'You get a METAR that reads: KJFK 121853Z 09014G25KT 3SM -RA BR BKN008 OVC015. Can you depart VFR?',
                answer: "Let me decode: JFK airport, winds 090 at 14 gusting 25, visibility 3 miles, light rain and mist, broken at 800 feet, overcast at 1,500 feet.<br><br><strong>No, I cannot depart VFR.</strong> JFK is in Class B airspace, which requires 3 miles visibility and clear of clouds. I have the visibility, but clouds at 800 feet broken and 1,500 overcast means there's no way to stay clear of clouds on departure.<br><br>I could request Special VFR (clear of clouds and 1 mile visibility), but honestly with light rain, mist, and an 800-foot ceiling, this is IFR weather - I'd file IFR or wait for improvement.",
                reference: '14 CFR 91.155',
                link: 'https://www.ecfr.gov/current/title-14/chapter-I/subchapter-F/part-91/subpart-B/subjgrp-42/section-91.155'
            },
            {
                question: 'What causes carburetor ice and when are you most likely to encounter it?',
                answer: "Carburetor ice forms when moisture in the air freezes inside the carburetor. Air passing through the venturi drops in pressure and temperature (can be 60-70Â°F drop), and fuel evaporation cools it further. If there's moisture and temps drop below freezing, ice forms on the throttle plate.<br><br>I'm most likely to get it at <strong>temperatures 20-70Â°F</strong> (worst case 50-70Â°F), high humidity, and low power settings like descent or taxi. Symptoms are rough running, RPM drop, and the engine may quit if severe.<br><br>I'd apply full carburetor heat at the first sign. RPM drops further initially as ice melts, then rises above original once ice is gone. I use carb heat proactively during descents and low-power operations.",
                reference: 'PHAK Chapter 7',
                link: 'https://www.faa.gov/regulations_policies/handbooks_manuals/aviation/phak'
            },
            {
                question: 'Explain the difference between stable and unstable air. How does each affect flying conditions?',
                answer: "<strong>Stable air</strong> resists vertical movement. If you push it up, it wants to settle back down. Characteristics: smooth flying, layered stratus clouds, steady precipitation, poor visibility, and fog. Minimal turbulence.<br><br><strong>Unstable air</strong> continues to rise once displaced upward, creating strong vertical currents. Characteristics: bumpy flying, towering cumulus clouds, showery precipitation, good visibility between showers. Significant turbulence.<br><br>If I see layered clouds and fog, it's stable air - smooth flight but poor visibility. If I see towering cumulus or thunderstorms, it's unstable - expect turbulence and avoid by 20 miles. Stable air often comes with warm fronts and inversions. Unstable air comes with cold fronts and surface heating.",
                reference: 'PHAK Chapter 12',
                link: 'https://www.faa.gov/regulations_policies/handbooks_manuals/aviation/phak'
            },
            {
                question: "You're planning a morning flight. The temperature is forecast to be 45Â°F and the dew point is 43Â°F. What weather should you expect?",
                answer: "With only a <strong>2Â°F spread</strong> between temperature and dew point, I should expect <strong>fog or low clouds</strong>. When temp and dew point are within 2-3Â°F, the air is nearly saturated. Any slight cooling will cause condensation and fog.<br><br>If it's a clear, calm night cooling into morning, expect radiation fog. If moist air is moving over cooler ground, expect advection fog. I'd check the forecast for the next few hours - fog often burns off by mid-morning as the sun heats the ground.<br><br>Radiation fog usually clears within 2-3 hours of sunrise. Advection fog can last all day if wind keeps bringing moist air.",
                reference: 'PHAK Chapter 12',
                link: 'https://www.faa.gov/regulations_policies/handbooks_manuals/aviation/phak'
            },
            {
                question: "What's an inversion and why is it dangerous for pilots?",
                answer: 'An <strong>inversion</strong> is when temperature increases with altitude instead of the normal decrease. It\'s dangerous because it traps pollution and haze below the warm layer, creating terrible visibility even on "clear" days. Poor low-level visibility makes arrivals and departures hazardous.<br><br>Inversions also create wind shear across the temperature layer, which can be significant during approach. If I accidentally enter clouds below an inversion, climbing won\'t help - clouds often extend through and above it.<br><br>Inversions form on calm, clear nights from radiational cooling, with warm fronts, or in morning departures before the sun heats the surface. If temps increase with altitude on the forecast, I\'m extra cautious about visibility and plan for possible IFR conditions.',
                reference: 'PHAK Chapter 12',
                link: 'https://www.faa.gov/regulations_policies/handbooks_manuals/aviation/phak'
            },
            {
                question: 'You see AIRMET Sierra, Tango, and Zulu on your weather briefing. What does each one mean?',
                answer: "AIRMETs are hazardous conditions for small aircraft.<br><br><strong>AIRMET Sierra:</strong> IFR conditions and mountain obscuration. Ceilings less than 1,000 feet or visibility less than 3 miles affecting over 50% of the area. I'd expect widespread IFR conditions.<br><br><strong>AIRMET Tango:</strong> Moderate turbulence or sustained surface winds 30 knots or more. I'd expect a rough ride and would secure loose items.<br><br><strong>AIRMET Zulu:</strong> Moderate icing and freezing levels. As a VFR pilot in a non-ice-protected aircraft, I avoid these areas entirely. If I see visible moisture and temps near freezing, I'm in serious danger.<br><br>AIRMETs are for light aircraft. SIGMETs are for all aircraft and are more severe.",
                reference: 'AIM 7-1-6',
                link: 'https://www.faa.gov/air_traffic/publications/atpubs/aim_html/chap7_section_1.html'
            },
            {
                question: "You're planning a morning departure. Ground temperature is 45Â°F, dew point is 43Â°F, and winds are calm. What type of fog might form and when can you expect it to clear?",
                answer: "With a 2Â°F temperature-dew point spread and calm winds, I should expect <strong>radiation fog</strong>. On a clear, calm night, the ground radiates heat and cools rapidly. Air near the surface cools by contact, and when it reaches the dew point, moisture condenses into fog. Calm winds keep the fog shallow - usually under 1,000 feet.<br><br>After sunrise, as the sun heats the ground, fog starts to thin and burn off from the bottom up. It usually clears 2-3 hours after sunrise. If sunrise is 6 AM, I'd plan departure for 8-9 AM. Once it starts clearing, it can dissipate within 30 minutes.",
                reference: 'PHAK Chapter 12',
                link: 'https://www.faa.gov/regulations_policies/handbooks_manuals/aviation/phak'
            },
            {
                question: "You're approaching your destination and see virga below you. What is it and should you be concerned?",
                answer: "<strong>Virga</strong> is precipitation falling from clouds but evaporating before reaching the ground. I'll see streaks extending down from clouds that fade out.<br><br><strong>Yes, I should be concerned.</strong> As rain evaporates, it cools the air, making it sink rapidly. This can create strong downdrafts or microbursts (over 1,000 fpm descent). On approach or departure, this can push me into the ground. Evaporating rain also creates temperature gradients and wind shear, plus reduced visibility and turbulence.<br><br>I'd avoid flying under virga if possible. If I must, I'd expect turbulence and downdrafts, maintain extra airspeed on approach, and be ready to go around.",
                reference: 'PHAK Chapter 12',
                link: 'https://www.faa.gov/regulations_policies/handbooks_manuals/aviation/phak'
            },
            {
                question: "What's a microburst and why is it so dangerous during takeoff and landing?",
                answer: "A <strong>microburst</strong> is an intense, localized downdraft from a thunderstorm that hits the ground and spreads out. It's usually less than 1 mile across but can have winds exceeding 100 knots and downdrafts over 6,000 fpm.<br><br>On approach, I first encounter a headwind (airspeed increases, I pitch up), then hit the downdraft (getting pushed down), then exit into a tailwind (airspeed drops dramatically). By the time I'm in the tailwind phase, I'm too low and slow to recover.<br><br>I recognize them through LLWS alerts from tower, visible rain shafts, dust rings on the ground, or airspeed fluctuations of 15+ knots. If I see microburst indicators, I go around immediately with max power and don't try to salvage the approach.",
                reference: 'AIM 7-1-26',
                link: 'https://www.faa.gov/air_traffic/publications/atpubs/aim_html/chap7_section_1.html'
            },
            {
                question: 'How do you determine the freezing level using a Winds Aloft forecast, and why is that critical for flight planning in visible moisture?',
                answer: "I find the freezing level by looking at winds aloft temperatures. If 6,000 feet shows +04Â°C and 9,000 feet shows -02Â°C, the freezing level is between them. At a standard 2Â°C per 1,000 feet lapse rate, I'd estimate around 7,500 feet.<br><br>It's critical because if I'm flying in visible moisture (clouds, rain) at temperatures between 0Â°C and -20Â°C, I'm at risk for structural icing. As a VFR pilot without ice protection, I cannot fly in these conditions. I need to stay below the freezing level or climb above the clouds. If I can't do either, I can't make the flight.",
                reference: 'AC 00-45',
                link: 'https://www.faa.gov/regulations_policies/advisory_circulars/index.cfm/go/document.information/documentID/1030235'
            },
            {
                question: 'Explain mountain wave turbulence and how to identify it.',
                answer: "<strong>Mountain wave</strong> is a standing wave downwind of mountains when strong winds (40+ knots) blow perpendicular to a range. Wind hits the mountain, is forced over, then descends and bounces back up in a wave pattern. These waves extend 100+ miles downwind and can reach 40,000+ feet.<br><br>It's dangerous because of severe turbulence, downdrafts of 2,000-8,000 fpm that can exceed climb capability, and violent rotor clouds near the surface.<br><br>I identify it by <strong>lenticular clouds</strong> (smooth, lens-shaped clouds that don't move), cap clouds over peaks, ragged rotor clouds, winds 40+ knots perpendicular to mountains, and stable air. If I see lenticular clouds, I stay away. I'd avoid flying near mountains when these conditions exist.",
                reference: 'PHAK Chapter 12',
                link: 'https://www.faa.gov/regulations_policies/handbooks_manuals/aviation/phak'
            },
            {
                question: "What's the difference between a SIGMET and a convective SIGMET?",
                answer: '<strong>SIGMET</strong> covers hazardous weather other than thunderstorms: severe/extreme turbulence, severe icing, widespread dust/sandstorms, volcanic ash. Valid for up to 4 hours and affects all aircraft.<br><br><strong>Convective SIGMET</strong> covers thunderstorms only: severe thunderstorms (surface winds 50+ knots, hail 3/4" or larger, tornadoes), embedded thunderstorms, or lines of thunderstorms. Valid for up to 2 hours, issued hourly.<br><br>The key difference: SIGMETs are for non-thunderstorm hazards, convective SIGMETs are specifically for thunderstorms. If I see either on my route, I seriously reconsider the flight. These are warnings for all aircraft, not just light planes. For convective SIGMETs, I stay at least 20 miles away.',
                reference: 'AIM 7-1-6',
                link: 'https://www.faa.gov/air_traffic/publications/atpubs/aim_html/chap7_section_1.html'
            },
            {
                question: "You're flying cross-country and see a line of towering cumulus building directly on your route, about 20 miles ahead. What does this tell you and what should you do?",
                answer: "<strong>Towering cumulus</strong> indicates strong updrafts and unstable air. They're the precursor to thunderstorms and can develop into cumulonimbus in 20-30 minutes. I'd expect moderate to severe turbulence in and near the clouds, icing risk above freezing level, and possible thunderstorms soon.<br><br>I do not fly through them. Even if they're not thunderstorms yet, turbulence inside can be severe. I'd stay at least 5 miles clear, increasing to 20 miles if they're developing into thunderstorms.<br><br>I'd call Flight Watch or ATC for updated weather, check for convective SIGMETs, and look for PIREPs. If the line is extensive and building, the safe move is to land and wait it out rather than trying to beat the weather.",
                reference: 'PHAK Chapter 12',
                link: 'https://www.faa.gov/regulations_policies/handbooks_manuals/aviation/phak'
            },
            {
                question: 'Your destination TAF reads "TEMPO 1820 1SM BR" during your planned arrival time. What does this mean and do you need to file an alternate?',
                answer: "TEMPO means temporary fluctuations between 1800Z and 2000Z, with visibility dropping to 1 mile in mist. For VFR flight, there's no legal requirement to file an alternate, but I should ask if I can complete the flight VFR. Most airports require 3 miles visibility for VFR. If it drops to 1 mile, I'm below minimums. TEMPO means it could last less than an hour but happen repeatedly.<br><br>I'd plan an alternate nearby not affected by mist, delay departure until after the TEMPO period passes, or file IFR if I'm rated and equipped. Even though I'm not legally required to file an alternate for VFR, I'd plan one anyway. Weather can worsen unexpectedly.",
                reference: 'AC 00-45',
                link: 'https://www.faa.gov/regulations_policies/advisory_circulars/index.cfm/go/document.information/documentID/1030235'
            },
            {
                question: "You're flying at 5,500 feet and your transponder fails. What do you do?",
                answer: "First, fly the airplane and maintain VFR. Whether I can continue depends on airspace.<br><br>In Class E or G, I can continue - no transponder requirement. Approaching Class C or B, I cannot enter and must divert around or land before entering. If already in Class C or B, I'd immediately notify ATC, explain the situation, and follow their instructions to exit or land.<br><br>Above 10,000 MSL or in the Mode C veil (within 30 nm of Class B), I also need a transponder. I'd descend below 10,000 outside the veil, or land as soon as practical. Bottom line: note the failure, squawk it for maintenance, and avoid airspace requiring a transponder.",
                reference: '14 CFR 91.215',
                link: 'https://www.ecfr.gov/current/title-14/chapter-I/subchapter-F/part-91/subpart-C/section-91.215'
            },
            {
                question: 'Can you fly through a restricted area?',
                answer: 'It depends if it\'s active. Restricted areas are designated for hazardous activities like artillery or missiles, marked with an "R" number on charts.<br><br>If active, I cannot enter without permission from the controlling agency. Times of use are in the Chart Supplement, and I\'d check NOTAMs. If I need to transit, I\'d contact the controlling agency and request permission.<br><br>If inactive, yes - it reverts to whatever airspace it\'s in (usually Class E or G) and I can transit freely. I\'d check the Chart Supplement for times, call Flight Service or the controlling agency to confirm status, and check NOTAMs. If in doubt, I go around - busting active restricted airspace can include certificate action.',
                reference: 'AIM 3-4-3',
                link: 'https://www.faa.gov/air_traffic/publications/atpubs/aim_html/chap3_section_4.html'
            },
            {
                question: "You're flying VFR at 9,500 feet in Class E airspace and encounter a cloud layer at 10,000 feet. You need to climb to 11,500 for your route. What are your legal options?",
                answer: "In Class E below 10,000 MSL, I need 3 miles visibility and 500 feet below, 1,000 feet above, 2,000 feet horizontal from clouds. With clouds at 10,000 feet, I can legally be as high as 9,000 feet.<br><br>My options: deviate laterally and find a gap to climb through VFR while maintaining 2,000 feet horizontal clearance, wait for clouds to dissipate, descend and take a lower altitude if practical, or cancel the flight and divert. What I cannot do is climb through the clouds - that's IFR flight. If there's no way to get to 11,500 while maintaining VFR, I'd divert or land.",
                reference: '14 CFR 91.155',
                link: 'https://www.ecfr.gov/current/title-14/chapter-I/subchapter-F/part-91/subpart-B/subjgrp-42/section-91.155'
            },
            {
                question: "You're practicing slow flight at 3,000 feet AGL directly over your small hometown. Are you legal? What about over the surrounding farmland?",
                answer: "Over my hometown, probably not legal. The minimum altitude over a congested area is 1,000 feet above the highest obstacle within 2,000 feet horizontally. At 3,000 feet AGL I'm probably legal altitude-wise, but practicing slow flight over a town where I'm near stall speed and could lose control is careless or reckless operation.<br><br>Over farmland, probably legal. Over non-congested areas, minimum altitude is 500 feet above the surface. At 3,000 feet AGL I'm well above that. But if I'm near someone's house or livestock, that could still be a problem.<br><br>The safe answer: practice slow flight well away from populated areas, use a designated practice area at least 3,000 feet AGL.",
                reference: '14 CFR 91.119 & 14 CFR 91.13',
                link: '#'
            },
            {
                question: "What's the difference between Class D and Class E surface area? How do you identify each on a sectional chart?",
                answer: "<strong>Class D</strong> has an operating control tower, shown as blue dashed lines, typically 4.4 nm radius extending surface to 2,500 feet AGL. Two-way radio communication required. Reverts to Class E or G when tower closes.<br><br><strong>Class E surface area</strong> has no tower or a non-Federal tower, shown as magenta dashed lines. Used for airports with instrument approaches but no tower. Extends from surface upward. No communication required for VFR, same weather minimums as other Class E.<br><br>The key difference: Class D requires radio communication and has a tower. Class E surface areas don't. Blue dashed line = Class D (tower). Magenta dashed line = Class E surface area (no tower, but has instrument approaches).",
                reference: 'AIM 3-2-5 & 3-2-6',
                link: '#'
            },
            {
                question: "You're flying VFR and want to transition through Class B airspace. What do you need?",
                answer: 'I need three things: ATC clearance (they must say my callsign and "cleared to enter Class Bravo" or "cleared through"), Mode C transponder operating and reporting altitude, and two-way radio communication maintained with ATC.<br><br>Additional requirements: private pilot certificate or higher (students need special endorsement) and 3 miles visibility, clear of clouds.<br><br>I\'d call: "[City] Approach, [Callsign], 10 miles south at 4,500, request Bravo transition northbound." If they respond "cleared through the Class Bravo," I\'m legal. If they say "remain clear," I cannot enter. Just talking to ATC isn\'t enough - I need specific clearance.',
                reference: '14 CFR 91.131',
                link: 'https://www.ecfr.gov/current/title-14/chapter-I/subchapter-F/part-91/subpart-B/subjgrp-43/section-91.131'
            },
            {
                question: 'Explain what a TFR is and how you check for them.',
                answer: 'A <strong>TFR</strong> (Temporary Flight Restriction) is airspace temporarily restricted for safety, security, or special events. Common reasons: presidential movements (30 nm radius), disaster areas, sporting events (3 nm radius, 1 hour before to 1 hour after), space launches, VIP movements, and security.<br><br>I check via 1800wxbrief.com or calling Flight Service (TFRs included in briefings), tfr.faa.gov (official FAA website showing active TFRs), or ForeFlight/Garmin Pilot apps.<br><br>Busting a TFR, especially presidential or security, can result in military interception, certificate suspension or revocation, and criminal charges. I check for TFRs every time I fly, brief them during planning, and if one pops up mid-flight, I avoid it or land.',
                reference: '14 CFR 91.137-145',
                link: 'https://www.ecfr.gov/current/title-14/chapter-I/subchapter-F/part-91/subpart-B/subjgrp-44'
            },
            {
                question: 'You see a blue segmented line on your sectional chart. What does it mean?',
                answer: 'A blue segmented line indicates the boundary of <strong>Class D airspace</strong> - there\'s an operating control tower at this airport. The airspace extends from surface to a specified altitude (usually 2,500 feet AGL). I need to establish two-way radio communication before entering.<br><br>The exact altitude is shown in a box near the airport. Class D usually has a 4.4 nm radius. When the tower is closed, it usually reverts to Class E or G.<br><br>Before entering, I\'d contact the tower: "[Airport] Tower, [Callsign], 10 miles south, 3,500, inbound for landing with [ATIS]." Once they respond with my callsign, communication is established and I can enter.',
                reference: 'AIM 3-2-5',
                link: 'https://www.faa.gov/air_traffic/publications/atpubs/aim_html/chap3_section_2.html'
            },
            {
                question: "What's the minimum safe altitude over congested areas? Over non-congested areas?",
                answer: "Over congested areas (cities, towns), it's <strong>1,000 feet above the highest obstacle within a horizontal radius of 2,000 feet</strong>. If the tallest building is 500 feet, I need to be at least 1,500 feet MSL minimum.<br><br>Over non-congested areas (open land, farms), it's <strong>500 feet above the surface</strong>. I can't operate closer than 500 feet to any person, vessel, vehicle, or structure.<br><br>Over water or sparsely populated areas, it's <strong>500 feet from any person, vessel, vehicle, or structure</strong> with no minimum altitude otherwise, as long as I'm not careless or reckless. Exceptions for takeoff, landing, and emergencies obviously apply.",
                reference: '14 CFR 91.119',
                link: 'https://www.ecfr.gov/current/title-14/chapter-I/subchapter-F/part-91/subpart-B/subjgrp-42/section-91.119'
            },
            {
                question: "You're flying at 8,500 feet on a 4-hour cross-country flight. Do you need supplemental oxygen? What about your passenger?",
                answer: "For me, at 8,500 feet I don't need oxygen for the first 30 minutes. After 30 minutes above 8,000 feet MSL, I must use it for the duration above 8,000 feet. Since this is a 4-hour flight, I'd be required to use oxygen after the first 30 minutes.<br><br>For my passenger, they're required to have oxygen available above 15,000 feet MSL. At 8,500 feet they don't legally need it, but I should offer it anyway - people vary in susceptibility to hypoxia.<br><br>The regulation: 12,500 to 14,000 MSL, crew must use oxygen after 30 minutes. Above 14,000 MSL, crew must use it the entire time. Above 15,000 MSL, everyone must be provided oxygen.",
                reference: '14 CFR 91.211',
                link: 'https://www.ecfr.gov/current/title-14/chapter-I/subchapter-F/part-91/subpart-C/section-91.211'
            },
            {
                question: "What's a Mode C veil and what equipment do you need to fly in it?",
                answer: "The <strong>Mode C veil</strong> is a 30 nautical mile radius around the primary airport of each Class B airspace, extending surface to 10,000 feet MSL. Equipment required: Mode C transponder (altitude-encoding) and ADS-B Out.<br><br>Even if I'm not entering Class B itself, if I'm within 30 nm of a Class B airport and below 10,000 MSL, I need Mode C and ADS-B Out. This catches a lot of pilots - you don't have to be in the Bravo, just near it.<br><br>Example: flying 25 miles from a Class B airport at 5,000 feet in Class E airspace. I'm not in Class B, but I'm in the veil and need transponder and ADS-B. The veil is shown as a thin magenta circle on sectional charts.",
                reference: '14 CFR 91.215 & 91.225',
                link: '#'
            },
            {
                question: "You're VFR and accidentally enter a cloud. You have your private pilot certificate and the aircraft is IFR-equipped. What are you legally allowed to do?",
                answer: 'Even though I have a private certificate and the aircraft is IFR-equipped, I\'m NOT legal to fly in IMC without an instrument rating. Inadvertent IMC absolutely qualifies as an emergency for a VFR-only pilot.<br><br>As PIC, I have authority to deviate from any regulation to meet an emergency. I\'d use my basic instrument training to maintain aircraft control, execute a 180-degree standard-rate turn back to VFR conditions, and contact ATC immediately on 121.5 if necessary: "[Callsign], VFR pilot in IMC, need immediate assistance."<br><br>What I cannot do is continue in IMC just because the aircraft is equipped, or file IFR (I\'m not rated). Inadvertent IMC is an emergency. I use whatever tools I have to get out safely, then land as soon as practical.',
                reference: '14 CFR 91.3 & 61.3',
                link: '#'
            },
            {
                question: "You're planning to fly into Class C airspace. When do you need to contact approach?",
                answer: 'I need to contact approach <strong>before entering</strong> Class C airspace. Class C has an inner shelf (surface to 4,000 feet AGL, 5 nm radius) and outer shelf (1,200 feet AGL to 4,000 feet AGL, 10 nm radius).<br><br>The requirement is to establish two-way radio communication with ATC before entering. I don\'t need a clearance like Class B - just communication.<br><br>I\'d call: "[City] Approach, [Callsign], 15 miles southeast at 3,500, inbound for landing with [ATIS]." If they respond with my callsign, communication is established and I can enter. Additional requirements while in Class C: Mode C transponder, ADS-B Out, maintain 3 miles visibility and standard VFR cloud clearances, and stay in contact with ATC.',
                reference: '14 CFR 91.130',
                link: 'https://www.ecfr.gov/current/title-14/chapter-I/subchapter-F/part-91/subpart-B/subjgrp-43/section-91.130'
            },
            {
                question: "What's special use airspace and what are the different types?",
                answer: "Special use airspace has limitations on aircraft not part of the designated activity.<br><br><strong>Prohibited (P-):</strong> Absolutely no entry ever. Examples: White House, Camp David. Federal offense to violate.<br><br><strong>Restricted (R-):</strong> Hazardous activities. Can fly through when inactive. Check NOTAMs and Chart Supplement.<br><br><strong>Warning (W-):</strong> Over international waters beyond 3 nm offshore. Hazardous but no legal prohibition. Not recommended.<br><br><strong>MOA:</strong> Military training. VFR flight allowed but expect heavy military traffic and turbulence.<br><br><strong>Alert (A-):</strong> High pilot training or unusual activity. No restrictions, just be alert.<br><br><strong>Controlled Firing Area:</strong> Artillery/missiles. Activities suspended when aircraft approach. Not charted.<br><br>I'd avoid all special use airspace when active and check NOTAMs before flight.",
                reference: 'AIM 3-4',
                link: 'https://www.faa.gov/air_traffic/publications/atpubs/aim_html/chap3_section_4.html'
            },
            {
                question: "You're approaching a Class D airport and the tower just closed for the night (it's now Class E). What changes about how you operate?",
                answer: "When the tower closes, the airspace reverts to Class E or G. No radio communication requirement - I use CTAF for self-announcing. No clearance needed for landing/takeoff. If it becomes Class E surface area, same VFR weather minimums. If it becomes Class G, VFR minimums change (1 mile vis, clear of clouds at night below 1,200 AGL).<br><br>No separation services - I'm responsible for see and avoid using CTAF. Some runway lights may be pilot-controlled (PCL) - I'd click the mic 3, 5, or 7 times on CTAF.<br><br>What stays the same: right-of-way rules, traffic pattern procedures, airport signs. I'd check the Chart Supplement for tower hours and what airspace it becomes, and be extra vigilant for traffic.",
                reference: 'AIM 3-2-5 & Chart Supplement',
                link: '#'
            },
            {
                question: "What's the speed limit below 10,000 feet? In Class B airspace? In the traffic pattern?",
                answer: "Below 10,000 feet MSL: <strong>250 knots</strong> indicated airspeed maximum, everywhere.<br><br>In Class B airspace: still 250 knots below 10,000 MSL, no speed limit above 10,000 MSL.<br><br>Within Class B inner core (underlying): <strong>200 knots</strong> when operating below the floor.<br><br>In Class C or D within 4 nm of primary airport and below 2,500 feet AGL: <strong>200 knots</strong>.<br><br>In the traffic pattern (Class D or E): <strong>200 knots</strong>.<br><br>Below Class B or Class C floors within lateral limits: <strong>200 knots</strong>.<br><br>I remember: default is 250 knots below 10,000 MSL, near airports or in patterns it's 200 knots.",
                reference: '14 CFR 91.117',
                link: 'https://www.ecfr.gov/current/title-14/chapter-I/subchapter-F/part-91/subpart-B/subjgrp-42/section-91.117'
            },
            {
                question: 'Explain right-of-way rules. Who has priority when?',
                answer: "When converging: aircraft in distress always has right of way, then balloons (least maneuverable), gliders, airships, and powered aircraft. Between two powered aircraft, the aircraft on the right has right of way - I give way to traffic on my right.<br><br>Head-on: both alter course to the right.<br><br>Overtaking: the aircraft being overtaken has right of way. I pass to the right and stay clear.<br><br>Approaching to land: lower aircraft has right of way, but can't cut in front of another on final or overtake them.<br><br>On the ground: aircraft landing or on final have right of way over taxiing aircraft. When paths cross, aircraft on the right has right of way.<br><br>Even with right of way, I still see and avoid - don't assume they see me.",
                reference: '14 CFR 91.113',
                link: 'https://www.ecfr.gov/current/title-14/chapter-I/subchapter-F/part-91/subpart-B/subjgrp-42/section-91.113'
            },
            {
                question: 'You hear on the radio: "November 12345, cleared to land runway 27" but you count three aircraft ahead of you in the pattern. What\'s going on and what should you do?',
                answer: 'Likely: tower cleared the wrong aircraft (wrong callsign), they\'re clearing someone out of sequence, or I miscounted. Don\'t land if I\'m not November 12345 - if they didn\'t say my callsign, I don\'t have clearance.<br><br>I\'d verify: "[Callsign], confirming cleared to land runway 27?" or "Tower, [Callsign], I have three aircraft ahead of me on final, please confirm landing sequence."<br><br>If I see a conflict developing, I\'d go around. The key: don\'t assume a clearance is for me unless they say my callsign, and don\'t land if there\'s any doubt about sequence.',
                reference: 'AIM 4-3-2',
                link: 'https://www.faa.gov/air_traffic/publications/atpubs/aim_html/chap4_section_3.html'
            },
            {
                question: "You're approaching a non-towered airport. How do you know which runway to use?",
                answer: "I choose based on <strong>wind direction</strong> to land as close to into the wind as possible. I check AWOS/ASOS for current wind, listen to CTAF for what other aircraft are using, look at the wind sock/tetrahedron on the field, and check NOTAMs for closures.<br><br>Example: winds 270 at 10 knots, airport has runways 27 and 09, I'd use runway 27 (directly into the wind). With a crosswind, I choose the runway with the smallest crosswind component.<br><br>If other traffic is using a different runway, I'd follow the flow for safety even if it's not ideal for wind. I'd announce clearly if I need to use a different runway.",
                reference: 'AIM 4-1-9 & 4-3-3',
                link: '#'
            },
            {
                question: "What's the difference between CTAF, UNICOM, and MULTICOM?",
                answer: '<strong>CTAF</strong> is the frequency designated for traffic advisories at non-towered airports. Could be a UNICOM frequency, MULTICOM, or the tower frequency if closed. This is what I use to announce position and intentions. Found on sectional charts (magenta) and Chart Supplement.<br><br><strong>UNICOM</strong> is a private ground station providing airport information, typically run by the FBO. Frequencies usually 122.7, 122.8, 122.95, or 123.0. I can call for airport advisories (runway in use, wind, traffic). Often also the CTAF.<br><br><strong>MULTICOM</strong> is a frequency for aircraft-to-aircraft at airports with no tower or UNICOM. Frequency is 122.9. No ground station - just self-announcing.<br><br>CTAF is the frequency to use (look it up), UNICOM is someone on the ground with info, MULTICOM is aircraft-to-aircraft only.',
                reference: 'AIM 4-1-9',
                link: 'https://www.faa.gov/air_traffic/publications/atpubs/aim_html/chap4_section_1.html'
            },
            {
                question: 'Explain how the pitot-static system works and what instruments it powers.',
                answer: 'The pitot-static system measures air pressure to drive three instruments: airspeed indicator, altimeter, and vertical speed indicator.<br><br><strong>Pitot tube</strong> faces forward and captures ram air pressure (dynamic pressure), feeding only the airspeed indicator. It has a drain hole and usually heating to prevent ice.<br><br><strong>Static port</strong> is flush-mounted perpendicular to airflow, measuring atmospheric pressure (static pressure). It feeds all three instruments.<br><br><strong>Airspeed indicator</strong> compares ram air to static pressure - the difference is dynamic pressure, which translates to airspeed. <strong>Altimeter</strong> uses only static pressure - as you climb, pressure decreases. <strong>VSI</strong> measures rate of change in static pressure.<br><br>If pitot is blocked, airspeed fails but altimeter and VSI work. If static port is blocked, all three give false readings. Most aircraft have alternate static in the cockpit.',
                reference: 'PHAK Chapter 8',
                link: 'https://www.faa.gov/regulations_policies/handbooks_manuals/aviation/phak/media/09_phak_ch8.pdf'
            },
            {
                question: "You're planning a night cross-country and your passenger asks if you can depart 30 minutes after sunset. What do you need to consider?",
                answer: 'This is a trick question about currency. <strong>Night</strong> is defined as one hour after sunset to one hour before sunrise for logging and carrying passengers. So 30 minutes after sunset is technically still "day."<br><br>However, if I\'m carrying passengers, I need three takeoffs and landings to a full stop within 90 days during the period beginning one hour after sunset and ending one hour before sunrise. If my last three landings were during the day, I\'m not night current for night passengers.<br><br>Here\'s the trick: we depart in "day" conditions, but if any part of the flight extends into the official "night" period, and I\'m not night current, I\'m illegal the moment we cross that threshold. The safe answer: if I\'m not night current, I shouldn\'t take passengers on a flight going into night, even departing before the one-hour mark.',
                reference: '14 CFR 61.57(b) & 1.1',
                link: '#'
            },
            {
                question: 'During your runup, you notice the left mag has a 200 RPM drop and the right mag has a 75 RPM drop. What do you do?',
                answer: "<strong>I would not take off.</strong> That 200 RPM drop is outside acceptable limits. Most POHs specify maximum 125-175 RPM drop on each mag, and difference between the two shouldn't exceed 50 RPM.<br><br>A high mag drop usually means fouled spark plugs, ignition problem, or improper mixture. Before scrubbing, I'd try troubleshooting: lean the mixture aggressively and run the engine at higher RPM (around 2000) for 30 seconds to a minute to burn off lead fouling. Then back to full rich, normal runup RPM, and check mags again.<br><br>If it improves and both are within limits with less than 50 RPM difference, I could continue. If still high, I'm done and calling maintenance. Flying with a bad mag is asking for trouble - if the good one fails in flight, I'm on the questionable one. I'd note it in the squawk sheet either way.",
                reference: 'POH Section 4 & PHAK Chapter 7',
                link: '#'
            },
            {
                question: "You're on short final and your airspeed indicator suddenly drops to zero. What's likely happening and what do you do?",
                answer: "The <strong>pitot tube is blocked</strong> - probably ice, insects, or a cover not removed. With blocked pitot, ram air can't reach the airspeed indicator.<br><br>I'd fly by pitch and power. I know approach speed should be around 65-70 knots for a typical trainer. I know the sight picture and attitude for that speed. I use pitch for airspeed, power for altitude.<br><br>I'd turn on pitot heat (if ice), but it won't help if it's a cover or insects. I'd cross-check GPS groundspeed (adjusted for wind), tachometer for rough power setting, and sound/feel of the aircraft.<br><br>If comfortable flying by pitch/power and approach looks good, I'd continue. If not comfortable, go around and troubleshoot. After landing, check pitot for obstructions. I was trained to fly without airspeed during private training - this is manageable.",
                reference: 'PHAK Chapter 8',
                link: 'https://www.faa.gov/regulations_policies/handbooks_manuals/aviation/phak/media/09_phak_ch8.pdf'
            },
            {
                question: 'Explain the difference between indicated, calibrated, true, and ground speed. When does each matter for flight planning?',
                answer: "<strong>Indicated (IAS):</strong> What the airspeed indicator shows. Subject to instrument and position errors. Matters for flying the aircraft - I use IAS for V-speeds.<br><br><strong>Calibrated (CAS):</strong> IAS corrected for instrument and position errors. Usually within a few knots of IAS at cruise. Matters for POH performance calculations.<br><br><strong>True (TAS):</strong> Actual speed through the air mass. CAS corrected for altitude and temperature. Increases about 2% per 1,000 feet. Matters for flight planning - calculating time and fuel.<br><br><strong>Ground (GS):</strong> Actual speed over ground. TAS corrected for wind. Matters for navigation - how fast I'm actually getting somewhere.<br><br>For flight planning, I use TAS to calculate headwind/tailwind and GS to calculate how long to destination and fuel over the ground.",
                reference: 'PHAK Chapter 8',
                link: 'https://www.faa.gov/regulations_policies/handbooks_manuals/aviation/phak/media/09_phak_ch8.pdf'
            },
            {
                question: "You're doing your preflight and notice the left main tire looks low. How do you check if it's airworthy?",
                answer: "I'd check the sidewall for proper inflation pressure and compare visually to other tires. If it looks significantly low, I'd use a tire pressure gauge if available, check for cuts/bulges/cord showing, and look at wear indicators.<br><br>There's no specific tire pressure regulation, but the tire must be safe for intended operation under 14 CFR 91.7. If noticeably low, I'm not flying - a flat on landing could cause loss of control. As PIC, I determine airworthiness.<br><br>I'd get it serviced before flight. Not worth the risk.",
                reference: '14 CFR 91.7',
                link: 'https://www.ecfr.gov/current/title-14/chapter-I/subchapter-F/part-91/subpart-A/section-91.7'
            },
            {
                question: "Explain P-factor and when it's most pronounced.",
                answer: "<strong>P-factor</strong> (asymmetric thrust) happens because the descending propeller blade (right side in clockwise prop) has a higher angle of attack than the ascending blade, creating more thrust on the right side. This pulls the nose left.<br><br>It's most pronounced at high power and low airspeed (takeoff, climb), high angle of attack (nose high attitudes), and in tailwheel aircraft during takeoff when the tail is still down.<br><br>I compensate with right rudder pressure during takeoff and climb, and trim for hands-off flight once established.",
                reference: 'PHAK Chapter 5',
                link: 'https://www.faa.gov/regulations_policies/handbooks_manuals/aviation/phak/media/06_phak_ch5.pdf'
            },
            {
                question: "What causes a stall and what's the only way to recover?",
                answer: "A stall occurs when the <strong>critical angle of attack is exceeded</strong> - usually around 16-20 degrees. Airflow separates from the wing and lift decreases dramatically. It's NOT about airspeed - you can stall at any speed if you exceed critical angle of attack.<br><br>The ONLY way to recover: <strong>reduce angle of attack</strong> by pushing the yoke forward. This unstalls the wing.<br><br>Full recovery: push (reduce AOA), power (add full power if not already), level wings (coordinated rudder and aileron), climb (once flying again).<br><br>Never try to recover with power alone - you must reduce angle of attack first.",
                reference: 'PHAK Chapter 5',
                link: 'https://www.faa.gov/regulations_policies/handbooks_manuals/aviation/phak/media/06_phak_ch5.pdf'
            },
            {
                question: "You're flying and your oil pressure drops to zero but oil temperature is normal. What do you do?",
                answer: "This could be gauge failure (sensor failed, oil pressure actually fine) or actual oil pressure loss (catastrophic failure imminent). Oil temp being normal suggests the gauge might be bad, but I can't bet my life on it.<br><br>I'd assume the worst and treat it as real oil pressure loss. Reduce power immediately to minimize damage, find a place to land NOW (airport if close, field if not), and prepare for engine failure - I might only have minutes before seizure.<br><br>I don't troubleshoot in the air. I land as soon as possible and let a mechanic figure it out.",
                reference: 'POH Emergency Procedures',
                link: 'https://www.faa.gov/regulations_policies/handbooks_manuals/aviation/'
            },
            {
                question: 'Explain how trim works and why you should use it.',
                answer: 'Trim relieves control pressure by adjusting a small hinged surface (trim tab) on the elevator, rudder, or ailerons. When I turn the trim wheel, it moves the trim tab, which deflects into the airflow and pushes the entire control surface the opposite direction, holding it in position without me applying pressure.<br><br>I use it to reduce pilot fatigue (flying for hours with pressure is exhausting), improve control (trimmed aircraft is more stable and precise), and for safety (if I need to look at charts or handle an emergency, the aircraft stays stable).<br><br>Common mistake: using trim to climb or descend. I use pitch and power to establish the attitude I want, then trim to relieve pressure.',
                reference: 'PHAK Chapter 6',
                link: 'https://www.faa.gov/regulations_policies/handbooks_manuals/aviation/phak/media/07_phak_ch6.pdf'
            },
            {
                question: "You're planning a flight from a sea-level airport to a mountain airport at 6,000 feet elevation. It's a hot summer day (95Â°F). How does density altitude affect your takeoff and landing performance?",
                answer: "Density altitude is pressure altitude corrected for temperature. On a 95Â°F day at 6,000 feet, density altitude could be 9,000+ feet.<br><br><strong>Takeoff:</strong> longer takeoff roll (less lift and thrust), reduced climb rate (less power), higher true airspeed (my indicated 60 knots is actually 70+ true).<br><br><strong>Landing:</strong> higher groundspeed even at normal indicated approach speed, longer landing roll (less effective brakes).<br><br>I'd check POH performance charts for density altitude, consider if runway is long enough, depart early morning when cooler if possible, and lean the mixture for ground operations and takeoff at high altitude.",
                reference: 'PHAK Chapter 11',
                link: 'https://www.faa.gov/regulations_policies/handbooks_manuals/aviation/phak/media/12_phak_ch11.pdf'
            },
            {
                question: 'Why is an aft CG position dangerous, specifically regarding aircraft stability, stall characteristics, and spin recovery?',
                answer: "<strong>Reduced stability:</strong> Less weight on the tail means less tendency to return to level flight. Aircraft becomes more responsive but less stable, harder to maintain pitch control.<br><br><strong>Worse stall characteristics:</strong> Lower stall speed (sounds good but isn't), more abrupt stall that can snap into a spin without warning, less effective elevator authority to recover.<br><br><strong>Difficult spin recovery:</strong> Forward CG helps the nose drop in a spin, aiding recovery. Aft CG keeps the nose up, making recovery extremely difficult or impossible. Some aircraft become unrecoverable from spins with aft CG.<br><br><strong>Reduced elevator effectiveness:</strong> At aft CG, elevator has less moment arm and may not be able to flare properly on landing.<br><br>Bottom line: never fly outside CG limits. It's not negotiable.",
                reference: 'PHAK Chapter 10',
                link: 'https://www.faa.gov/regulations_policies/handbooks_manuals/aviation/phak/media/11_phak_ch10.pdf'
            },
            {
                question: "What's ground effect and when do you experience it?",
                answer: 'Ground effect occurs when flying very close to the ground (within one wingspan of the surface). The ground interferes with wingtip vortices, reducing induced drag and increasing lift.<br><br>I experience it on takeoff as I lift off - the aircraft "floats" and feels like it has extra lift. On landing in the flare, the aircraft wants to float down the runway.<br><br>Why it\'s important: on takeoff, I might lift off earlier due to extra lift, but as I climb out of ground effect, I lose that performance. If heavy or at high density altitude, I could lift off but not be able to climb - very dangerous. On landing, aircraft floats in ground effect and I need to be patient in the flare.<br><br>I don\'t rotate early just because ground effect makes it feel easy, and I anticipate the float on landing.',
                reference: 'PHAK Chapter 5',
                link: 'https://www.faa.gov/regulations_policies/handbooks_manuals/aviation/phak/media/06_phak_ch5.pdf'
            },
            {
                question: "You notice your ammeter is showing a discharge. What's happening and what do you do?",
                answer: "The alternator has failed or the belt broke. The battery is now powering all electrical systems and will drain quickly.<br><br>I'd reduce electrical load immediately (turn off non-essential equipment, keep one comm radio and transponder if in controlled airspace), land as soon as practical (I have 30-60 minutes of battery), notify ATC if in controlled airspace, and plan for total electrical failure (loss of radios, transponder, GPS, lighting).<br><br>If battery dies, I lose everything electrical. I'd know how to navigate without GPS and have a flashlight for night flight.",
                reference: 'POH Emergency Procedures',
                link: 'https://www.faa.gov/regulations_policies/handbooks_manuals/aviation/'
            },
            {
                question: 'You land at a remote airport and the starter fails. A mechanic offers to hand-prop the aircraft for you. Are you legally allowed to do this? What are the safety risks?',
                answer: "Legally, yes, hand-propping is legal if a qualified person is at the controls and proper procedures are followed.<br><br><strong>Safety risks:</strong> The prop can kill someone instantly if it catches them. Must use proper technique: pull through briskly and step back. Aircraft can roll forward if brakes aren't set or chocks aren't in place. If mags are hot when not expected or throttle is too high, the aircraft can start unexpectedly or surge forward.<br><br>I'd require a qualified pilot at the controls with brakes set, chocks in front of wheels, mags OFF until ready, idle throttle, and the person propping knows what they're doing.<br><br>Honestly, I'd rather call for help than hand-prop unless absolutely necessary.",
                reference: 'AC 91-13C',
                link: 'https://www.faa.gov/regulations_policies/advisory_circulars/index.cfm/go/document.information/documentID/22794'
            },
            {
                question: "You're cruising at 8,500 feet and notice your EGT is unusually low and fuel flow is higher than normal. What's likely wrong and what do you do?",
                answer: "The mixture is too <strong>rich</strong>. At 8,500 feet, I should have leaned but didn't or didn't lean enough.<br><br>Rich mixture = excess fuel = cooler EGT and higher fuel flow than necessary. This wastes fuel, can foul spark plugs over time, and reduces engine performance.<br><br>I'd lean the mixture slowly by pulling the knob until EGT peaks, then enrichen slightly. Fuel flow should decrease to normal range. I'd monitor engine performance - should run smoother and more efficiently.<br><br>At altitude, always lean the mixture for cruise. Rule of thumb: lean above 3,000 feet density altitude.",
                reference: 'PHAK Chapter 7',
                link: 'https://www.faa.gov/regulations_policies/handbooks_manuals/aviation/phak/media/08_phak_ch7.pdf'
            },
            {
                question: "You're at 8,500 feet and notice your engine is running rough. What's the likely cause?",
                answer: "Most likely: improper mixture. At 8,500 feet without leaning, the engine is running too rich and will run rough.<br><br>Other possibilities: carburetor ice (apply carb heat to check), magneto problem (partial mag failure), or fouled spark plugs from running rich.<br><br>I'd lean the mixture first - usually fixes it immediately. Then check carb heat (pull it on, see if roughness changes), check mags individually (switch to LEFT then RIGHT), and monitor engine gauges (oil pressure, oil temp, CHT, EGT).<br><br>If leaning doesn't fix it, I'd troubleshoot other systems and be ready to land if roughness worsens.",
                reference: 'POH & PHAK Chapter 7',
                link: '#'
            },
            {
                question: "You're turning from base to final and the nose swings past your desired heading. What causes this and how do you prevent it?",
                answer: "<strong>Overbanking tendency:</strong> In a turn, the outer wing travels faster, generating more lift, which wants to increase bank angle. Combined with rudder input, the nose can swing past where I want.<br><br><strong>Adverse yaw:</strong> When I apply aileron to roll out, the down aileron creates more drag, yawing the nose opposite my roll direction.<br><br>I prevent it with coordinated rudder (keep the ball centered), leading the rollout (start rolling before reaching desired heading), small control inputs (don't over-control), and practice.<br><br>If it happens, I'd neutralize controls, let the aircraft stabilize, and re-establish heading with coordinated inputs.",
                reference: 'PHAK Chapter 5',
                link: 'https://www.faa.gov/regulations_policies/handbooks_manuals/aviation/phak/media/06_phak_ch5.pdf'
            },
            {
                question: 'During cruise, you smell fuel in the cockpit. Walk me through your decision process - when do you land immediately vs continue to destination?',
                answer: "Fuel smell is a serious emergency.<br><br><strong>Land immediately if:</strong> strong fuel smell (overwhelming odor = major leak), visible fuel in cockpit or on windscreen, fuel gauges dropping rapidly (confirms leak), or any sign of fire (smoke, heat, flames).<br><br><strong>Continue cautiously if:</strong> very faint smell (might be residual from refueling), fuel gauges stable (no apparent leak), short distance to destination (less than 10 minutes), and good weather/runway.<br><br>Either way: turn off fuel boost pump if equipped, check fuel selector, open vents/windows for fresh air, no smoking or electrical switches (avoid ignition), and declare emergency if needed.<br><br>The safe answer: fuel leaks can lead to fire. I'm landing at the nearest suitable airport, not continuing.",
                reference: 'POH Emergency Procedures',
                link: 'https://www.faa.gov/regulations_policies/handbooks_manuals/aviation/'
            },
            {
                question: "Explain slow flight - why practice it and what's happening aerodynamically?",
                answer: 'Slow flight is flying at minimum controllable airspeed - just above stall speed, typically 1.2 to 1.3 Vso.<br><br><strong>Why practice:</strong> simulates approach and landing speeds, teaches feel for the airplane at low speed, builds stall awareness (recognize the edge), and improves coordination (requires constant small inputs).<br><br><strong>Aerodynamically:</strong> high angle of attack (wing near critical AOA), high induced drag (lots of power needed), mushy controls (less airflow), nose-high attitude, and increased stall speed in turns (load factor).<br><br>The key lesson: flying slow requires coordinated use of all controls - pitch, power, rudder, trim. It teaches me to fly precisely at the edge of the performance envelope.',
                reference: 'PHAK Chapter 5 & ACS',
                link: 'https://www.faa.gov/regulations_policies/handbooks_manuals/aviation/phak/media/06_phak_ch5.pdf'
            },
            {
                question: "What's Vx vs Vy? When do you use each?",
                answer: '<strong>Vx (Best Angle):</strong> Gains most altitude per distance traveled. Steeper climb, good for clearing obstacles. Slower airspeed. Use for short runways with trees at the end.<br><br><strong>Vy (Best Rate):</strong> Gains most altitude per unit of time. Faster climb to cruise altitude. Faster airspeed, shallower angle. Use for normal departures, getting to altitude quickly, better engine cooling.<br><br>After clearing obstacles, I transition from Vx to Vy for better cooling and faster climb.',
                reference: 'PHAK Chapter 11 & POH',
                link: 'https://www.faa.gov/regulations_policies/handbooks_manuals/aviation/phak/media/12_phak_ch11.pdf'
            },
            {
                question: "You're landing with a strong crosswind. Explain your technique.",
                answer: 'I use the crab and slip method. On approach, I crab into the wind (point nose into wind) to track centerline while maintaining wings level. In the flare, I kick out the crab (apply downwind rudder to align nose with runway), lower the upwind wing (apply upwind aileron to prevent drift), and land on the upwind wheel first (let aircraft weathervane into wind).<br><br>Alternative: wing-low method throughout - lower upwind wing from final approach, apply opposite rudder to keep nose aligned, fly the whole approach in a slip, land upwind wheel first.<br><br>Never let the aircraft drift across centerline. Be ready to go around if crosswind exceeds my comfort or aircraft limits. Add power as needed in the flare to control descent rate.',
                reference: 'PHAK Chapter 9 & POH',
                link: 'https://www.faa.gov/regulations_policies/handbooks_manuals/aviation/phak/media/10_phak_ch9.pdf'
            },
            {
                question: "What's hydroplaning and how do you prevent it?",
                answer: "Hydroplaning is when tires ride on a film of water instead of contacting pavement. I lose braking and steering effectiveness.<br><br>Types: dynamic (occurs around 9 x âˆštire pressure in knots, about 50-60 knots for GA tires), viscous (thin film, slower speeds), and reverted rubber (locked wheels on wet pavement generate steam).<br><br><strong>Prevention:</strong> land on longer runways when wet, don't lock brakes (gentle, gradual braking), touch down at minimum speed, avoid puddles, ensure proper tire pressure (under-inflated tires hydroplane easier).<br><br>If it happens: ease off brakes (let wheels spin to regain traction), use aerodynamic braking (hold nose up for drag), and don't panic and slam brakes (makes it worse).",
                reference: 'PHAK Chapter 9',
                link: 'https://www.faa.gov/regulations_policies/handbooks_manuals/aviation/phak/media/10_phak_ch9.pdf'
            },
            {
                question: "You're one hour into a cross-country and encounter an unforecast 20-knot headwind. How does this affect your legal VFR fuel reserves and what's your decision process?",
                answer: "My groundspeed drops by 20 knots, so time en route increases significantly. My fuel burn stays the same (based on power setting, not groundspeed). Legal VFR reserves are 30 minutes day, 45 minutes night.<br><br>I'd recalculate arrival fuel: if I planned 2 hours at 8 GPH (16 gallons), I now need 2.5 hours (20 gallons). Do I still have 30 minutes reserve after landing?<br><br>If reserves are tight, I'd divert to a closer airport and refuel, or land short of destination. If I don't have legal reserves, I cannot continue - I'm required to land with reserves. Find the nearest airport with fuel.<br><br>Don't push fuel. Land and refuel rather than arriving with minimum. Always have a fuel cushion beyond legal minimums.",
                reference: '14 CFR 91.151',
                link: 'https://www.ecfr.gov/current/title-14/chapter-I/subchapter-F/part-91/subpart-B/subjgrp-42/section-91.151'
            },
            {
                question: 'How do you calculate weight and balance? Walk me through an example.',
                answer: 'Weight and balance ensures I\'m within max gross weight and CG limits.<br><br>Steps: Find weights (empty aircraft 1,500 lbs, pilot 180, passenger 160, fuel 40 gal x 6 = 240, baggage 50). Find arms (each item has distance from datum - front seats 37", fuel 48", baggage 95"). Calculate moments (weight x arm: pilot+passenger 340 x 37 = 12,580, fuel 240 x 48 = 11,520, baggage 50 x 95 = 4,750, plus aircraft empty moment from POH).<br><br>Total weight and moment, divide total moment by total weight = CG location. Check limits: is total weight â‰¤ max gross? Is CG within forward and aft limits? If both yes, legal to fly.',
                reference: 'PHAK Chapter 10 & POH',
                link: 'https://www.faa.gov/regulations_policies/handbooks_manuals/aviation/phak/media/11_phak_ch10.pdf'
            },
            {
                question: "You're lost. What's your procedure using the 5 C's?",
                answer: '<strong>Climb:</strong> Gain altitude for better visibility and radio/GPS range. Look for landmarks.<br><br><strong>Communicate:</strong> Call ATC or Flight Service (122.2): "Flight Service, [Callsign], uncertain of position..." They can use radar to find me or triangulate.<br><br><strong>Confess:</strong> Admit I\'m lost. Declare emergency if fuel is low.<br><br><strong>Comply:</strong> Follow ATC instructions. Squawk 7700 if requested.<br><br><strong>Conserve:</strong> Reduce power to conserve fuel. Circle if necessary to stay in one area.<br><br>Additionally: use GPS if available (even handheld), look for pilotage clues (rivers, highways, towns), and use VOR triangulation if working VORs.',
                reference: 'AIM 6-3-1',
                link: 'https://www.faa.gov/air_traffic/publications/atpubs/aim_html/chap6_section_3.html'
            },
            {
                question: "You're 30 minutes into your cross-country and realize your heading indicator doesn't match your magnetic compass by 15 degrees. What's likely wrong and what do you do?",
                answer: "The heading indicator has precessed (drifted). Heading indicators are gyroscopic and need realignment with the magnetic compass every 15 minutes.<br><br>I'd cross-check navigation (am I tracking my course using GPS or VOR?), reset the heading indicator in straight-and-level unaccelerated flight by aligning with the magnetic compass, and verify the compass is accurate (not near metal or electrical interference, check deviation card).<br><br>This is normal - gyroscopic instruments drift over time. That's why we cross-check with the magnetic compass regularly. Not a big deal, just reset and continue. I'd do this every 15 minutes.",
                reference: 'PHAK Chapter 8',
                link: 'https://www.faa.gov/regulations_policies/handbooks_manuals/aviation/phak/media/09_phak_ch8.pdf'
            },
            {
                question: "You're tracking a VOR radial and notice the CDI needle is slowly drifting to the right. What does this mean and what should you do?",
                answer: 'Needle drifting right means I\'m left of course. Wind is pushing me left, and I need a wind correction angle to stay on the radial.<br><br>I\'d turn toward the needle (right) 20-30 degrees to intercept the radial. Once centered, I\'d turn to correct heading - don\'t just fly the original heading, add a wind correction angle (turn a few degrees right of original heading to compensate). I\'d monitor the CDI and adjust heading until the needle stays centered.<br><br>The rule: "Fly toward the needle" to get back on course.',
                reference: 'PHAK Chapter 16',
                link: 'https://www.faa.gov/regulations_policies/handbooks_manuals/aviation/phak/media/17_phak_ch16.pdf'
            },
            {
                question: "You planned your 2-hour cross-country with VFR fuel reserves. One hour in, you're 20 minutes behind schedule due to headwinds. What's your decision process?",
                answer: "I'm 20 minutes behind after 1 hour = 33% slower. If this continues, my 2-hour flight becomes 2 hours 40 minutes, eating into my 30-minute VFR reserve.<br><br>I'd recalculate fuel: do I have enough to complete plus 30 minutes reserve? If yes, continue but monitor closely. If no, divert now. Find closer alternates along my route, contact ATC or Flight Service for updated winds and check if conditions are improving.<br><br>Don't push it. If fuel reserves are threatened, I'm landing to refuel. Better to refuel than run out.",
                reference: '14 CFR 91.151',
                link: 'https://www.ecfr.gov/current/title-14/chapter-I/subchapter-F/part-91/subpart-B/subjgrp-42/section-91.151'
            },
            {
                question: 'Your GPS shows "RAIM NOT AVAILABLE" in the flight plan menu. Can you still use it for VFR navigation?',
                answer: "<strong>Yes.</strong> RAIM (Receiver Autonomous Integrity Monitoring) is only required for IFR GPS approaches. For VFR navigation, I can still use GPS even without RAIM.<br><br>RAIM means there aren't enough satellites for the GPS to verify accuracy to IFR standards, but it's still plenty accurate for VFR navigation.<br><br>I'd use GPS for situational awareness and navigation, cross-check with pilotage and VOR if available, and don't rely solely on GPS. If I were IFR, I couldn't shoot a GPS approach without RAIM.",
                reference: 'AIM 1-1-17',
                link: 'https://www.faa.gov/air_traffic/publications/atpubs/aim_html/chap1_section_1.html'
            },
            {
                question: 'Explain how to use pilotage and dead reckoning for navigation.',
                answer: "<strong>Pilotage:</strong> Using visual landmarks to navigate - rivers, roads, towns, towers. I identify checkpoints on my sectional, look for them during flight, and confirm I'm on course.<br><br><strong>Dead Reckoning:</strong> Navigating by time, heading, and airspeed calculations. Measure distance on chart, calculate time (distance Ã· groundspeed), fly the heading for that time, and arrive at the next checkpoint.<br><br>Best practice: use both together. Use dead reckoning to predict where I'll be, use pilotage to confirm I'm actually there.<br><br>Example: chart shows a lake 30 miles ahead, dead reckoning says 15 minutes. At 15 minutes, I look for the lake - if it's there, I'm on course.",
                reference: 'PHAK Chapter 16',
                link: 'https://www.faa.gov/regulations_policies/handbooks_manuals/aviation/phak/media/17_phak_ch16.pdf'
            },
            {
                question: 'You need to divert to an alternate airport. Walk me through your process.',
                answer: 'Choose the nearest suitable airport considering weather, runway length, and fuel availability using GPS or sectional. Calculate heading with GPS direct-to or eyeball it on chart. Calculate distance and time (GPS shows distance or measure on chart and divide by groundspeed).<br><br>Notify ATC if in contact: "Approach, [Callsign], diverting to [alternate] due to weather/fuel/emergency." Navigate by flying the heading and using pilotage to confirm tracking. Monitor fuel.<br><br>Brief the approach: get AWOS/ASOS, review runway layout, pattern altitude, and frequencies.<br><br>Keep it simple - get heading, fly it, land.',
                reference: 'PHAK Chapter 16',
                link: 'https://www.faa.gov/regulations_policies/handbooks_manuals/aviation/phak/media/17_phak_ch16.pdf'
            },
            {
                question: "What's the purpose of a flight plan and when are you required to file one?",
                answer: "<strong>Purpose:</strong> Search and rescue. If I don't close my flight plan, SAR will be initiated. It's not for ATC separation - VFR flight plans don't provide ATC services.<br><br><strong>When required:</strong> Never required for domestic VFR flight. Required for flights to/from the US across borders (Canada, Mexico) - this is a DVFR flight plan.<br><br><strong>When I'd file anyway:</strong> Over water or remote areas (if I go down, I want SAR looking), or long cross-countries (extra safety net).<br><br>File with Flight Service (1800wxbrief.com or phone), activate in the air or on ground, and close within 30 minutes of landing or SAR will launch. Common mistake: forgetting to close it.",
                reference: 'AIM 5-1-4',
                link: 'https://www.faa.gov/air_traffic/publications/atpubs/aim_html/chap5_section_1.html'
            },
            {
                question: "Explain how to determine if you're within gliding distance of an airport.",
                answer: "Glide ratio for most trainers is around 10:1 - for every 1,000 feet of altitude, I can glide about 10,000 feet (1.7 nm) with no wind.<br><br>I check my altitude AGL (at 5,000 feet AGL, I can glide about 8-9 nm accounting for wind and turns), look at distance to airport (GPS shows 6 nm), and account for wind (headwind reduces range, tailwind increases).<br><br>Rule of thumb: altitude in thousands AGL x 1.5 = glide range in nm. So 5,000 feet AGL = about 7-8 nm.<br><br>In practice, I always want to be within gliding distance of a suitable landing area (airport or field). Over mountains or water, this isn't always possible.",
                reference: 'PHAK Chapter 11',
                link: 'https://www.faa.gov/regulations_policies/handbooks_manuals/aviation/phak/media/12_phak_ch11.pdf'
            },
            {
                question: 'You notice your groundspeed is way lower than expected. What could cause this?',
                answer: "Most likely: stronger headwind than forecast. Other causes: wind shifted direction, incorrect heading (off course and fighting crosswind), power setting too low, or aircraft performance issue (drag from open door, ice, damage).<br><br>I'd check winds (compare GPS groundspeed to calculated TAS - difference is wind component), recalculate fuel (lower groundspeed = longer time = more fuel burn - do I have enough to reach destination plus reserves?), divert if fuel is tight, and check aircraft for extra drag (door ajar, gear not retracted fully, engine gauges).",
                reference: 'PHAK Chapter 16',
                link: 'https://www.faa.gov/regulations_policies/handbooks_manuals/aviation/phak/media/17_phak_ch16.pdf'
            },
            {
                question: "You're halfway to your destination and can't identify your position using landmarks. Your GPS and VOR both work. What's your procedure?",
                answer: "If I have GPS and VOR, I'm not really lost - I just can't visually identify where I am.<br><br>I'd use GPS (check current position, confirm on course, identify nearby landmarks on moving map), use VOR (tune nearby VOR, identify radial and distance, cross-check with another VOR), correlate to sectional chart (find GPS position on chart, look for landmarks I should see), and continue to destination.<br><br>I know where I am via GPS/VOR, just need to regain visual orientation. This is common - sometimes weather, haze, or unfamiliar terrain makes visual navigation hard. That's why we have GPS and VORs.",
                reference: 'PHAK Chapter 16',
                link: 'https://www.faa.gov/regulations_policies/handbooks_manuals/aviation/phak/media/17_phak_ch16.pdf'
            },
            {
                question: 'You notice a NOTAM for your destination: "RWY 27 CLSD, RWY 09 AVBL." You planned to land 27 with the winds. What do you do?',
                answer: "Runway 27 is closed, runway 09 is available (opposite direction), but winds favor 27 (I'm landing with a tailwind on 09).<br><br>I'd assess the tailwind (how strong? 5 knots? 15 knots? Can I safely land?), check POH limits (some aircraft have max tailwind components, often 10 knots), check landing distance with tailwind, and consider diverting (if tailwind is too strong or runway too short, divert to an alternate with favorable runway).<br><br>If landing, I'd plan for longer landing roll due to tailwind and add margin for go-around.<br><br>The safe answer: if tailwind exceeds limits or makes me uncomfortable, divert. Don't land in unsafe conditions.",
                reference: 'NOTAM system & POH',
                link: '#'
            },
            {
                question: "You're flying a heading of 090Â° but your GPS shows your track is 105Â°. What does this tell you?",
                answer: "I have wind from the left (north) pushing me right (south). Heading 090 = pointed east, track 105 = actually moving 15Â° right of east. The 15Â° difference is my drift caused by wind.<br><br>I'd apply wind correction angle by turning left to heading 075Â° to compensate, which should give me a track of 090Â°. I'd monitor GPS track to see if it moves back to 090Â° and adjust heading as needed. I'd also recalculate groundspeed since crosswind might affect it slightly.<br><br>This is normal - wind correction is a constant adjustment during cross-country flight.",
                reference: 'PHAK Chapter 16',
                link: 'https://www.faa.gov/regulations_policies/handbooks_manuals/aviation/phak/media/17_phak_ch16.pdf'
            },
            {
                question: 'Walk me through your IMSAFE checklist.',
                answer: "Before every flight, I run through IMSAFE to check if I'm fit to fly.<br><br><strong>Illness</strong> - Am I sick? Even a cold can mess with my judgment.<br><br><strong>Medication</strong> - Am I on anything that could impair me? Includes over-the-counter.<br><br><strong>Stress</strong> - Am I distracted by personal or work problems? If my head's not in the game, I shouldn't fly.<br><br><strong>Alcohol</strong> - At least 8 hours since my last drink and completely sober? Rule is 8 hours bottle-to-throttle and under 0.04%, but I use 24 hours to be safe.<br><br><strong>Fatigue</strong> - Am I tired or running on no sleep? Fatigue affects you like alcohol.<br><br><strong>Emotion</strong> - Am I angry, depressed, or emotionally worked up?<br><br>If I answer yes to any of these, I don't fly. I'm responsible for determining if I'm fit, and no flight is worth risking safety.",
                reference: 'PHAK Chapter 2',
                link: 'https://www.faa.gov/regulations_policies/handbooks_manuals/aviation/phak/media/03_phak_ch2.pdf'
            },
            {
                question: "You're on short final and see another aircraft landing on the same runway ahead of you. What do you do?",
                answer: '<strong>Immediate action: GO AROUND.</strong> Two aircraft on the same runway = collision risk.<br><br>Full power, pitch for Vy, flaps to takeoff setting (not all at once), climb out, and notify tower if towered: "Tower, [Callsign], going around, traffic on the runway."<br><br>After going around, I\'d re-enter the pattern and land when the runway is clear. Don\'t try to salvage a bad approach. Common mistake: trying to float over the other aircraft or land long. Never do this - go around instead.',
                reference: 'AIM 4-3-21',
                link: 'https://www.faa.gov/air_traffic/publications/atpubs/aim_html/chap4_section_3.html'
            },
            {
                question: 'Your engine fails at 3,000 feet AGL. Walk me through your immediate actions.',
                answer: 'Immediate actions in first 10 seconds:<br><br><strong>Airspeed</strong> - Pitch for best glide speed (typically 65-70 knots).<br><br><strong>Landing site</strong> - Pick a field or airport within gliding distance.<br><br><strong>Checklist</strong> - Run engine failure checklist: fuel selector BOTH, mixture RICH, carb heat ON, mags CHECK BOTH, primer IN and locked.<br><br><strong>Mayday call</strong> - "Mayday mayday mayday, [callsign], engine failure, [location], 3,000 feet, attempting forced landing."<br><br><strong>Squawk 7700</strong>.<br><br><strong>Trim</strong> for best glide.<br><br><strong>Plan approach</strong> - Set up for landing in the field.<br><br>If engine restarts, great - land at nearest airport. If not, commit to the field.',
                reference: 'POH Emergency Procedures',
                link: 'https://www.faa.gov/regulations_policies/handbooks_manuals/aviation/'
            },
            {
                question: "You smell smoke in the cockpit. What's your procedure?",
                answer: "Smoke or fire is an immediate emergency.<br><br>Identify the source (electrical? engine? cabin?). For electrical fire/smoke: master switch OFF if safe, vents/windows OPEN to ventilate, fire extinguisher if needed. For engine fire: fuel OFF, mixture CUTOFF, master OFF, land immediately.<br><br>Land ASAP - don't troubleshoot long, get on the ground NOW, declare emergency. Evacuate after landing and get away from the aircraft.<br><br>The key: ACT FAST. Don't spend time diagnosing - land immediately.",
                reference: 'POH Emergency Procedures',
                link: 'https://www.faa.gov/regulations_policies/handbooks_manuals/aviation/'
            },
            {
                question: "You're flying VFR and inadvertently enter IMC. What do you do?",
                answer: 'This is an emergency. Don\'t panic - spatial disorientation kills, trust the instruments. Execute a 180-degree standard-rate turn back to VFR conditions (turn for 1 minute or until heading opposite). Climb if I entered while climbing (stop climb or descend), or descend if entering while descending (climb back up).<br><br>Contact ATC on 121.5 if no other frequency: "Mayday, [callsign], VFR pilot inadvertent IMC, need immediate assistance." They\'ll help vector me out or to an airport. Fly the instruments (attitude indicator, heading indicator, altimeter) and maintain straight and level. Declare emergency and squawk 7700.<br><br>Don\'t try to continue VFR - I\'m not rated. Get out of clouds and land ASAP.',
                reference: 'AIM 5-5-13',
                link: 'https://www.faa.gov/air_traffic/publications/atpubs/aim_html/chap5_section_5.html'
            },
            {
                question: 'Explain the DECIDE model for aeronautical decision-making.',
                answer: "<strong>D - Detect</strong> the problem (recognize something is wrong, like weather deteriorating).<br><br><strong>E - Estimate</strong> the need to react (how serious? how much time?).<br><br><strong>C - Choose</strong> a desirable outcome (what's my goal? land safely? divert?).<br><br><strong>I - Identify</strong> possible actions (list options: continue, divert, land, turn around).<br><br><strong>D - Do</strong> the best action (execute the decision).<br><br><strong>E - Evaluate</strong> the effect (did it work? adjust?).<br><br>Example: Detect fuel lower than expected, Estimate 45 minutes left but destination is 50 minutes away, Choose to land with adequate reserves, Identify options (divert to airport 20 minutes ahead or turn back), Do divert to closer airport, Evaluate fuel now adequate, crisis averted.",
                reference: 'PHAK Chapter 2',
                link: 'https://www.faa.gov/regulations_policies/handbooks_manuals/aviation/phak/media/03_phak_ch2.pdf'
            },
            {
                question: "You're on a cross-country and realize you'll arrive 45 minutes after sunset. You're not night current for carrying passengers. Your passenger is on board. What's the issue and what do you do?",
                answer: 'Night for passenger currency is 1 hour after sunset to 1 hour before sunrise. Arriving 45 minutes after sunset means I\'m still within "day" period, but only 15 minutes away from entering "night."<br><br>I\'m legal now, but if the flight goes 15 minutes longer than planned, I\'m illegal.<br><br>I\'d calculate precisely (when is sunset? when is 1 hour after?), land at an intermediate airport NOW if it\'s close, or continue if I\'m certain I\'ll land before the 1-hour mark and monitor time closely.<br><br>The safe answer: if there\'s any doubt, land before the 1-hour mark. Don\'t risk a violation.',
                reference: '14 CFR 61.57(b) & 1.1',
                link: '#'
            },
            {
                question: 'Your passenger starts feeling airsick and wants you to land immediately. How do you handle this?',
                answer: "Airsickness is uncomfortable but usually not an emergency. I'd reassure them it's normal and will pass, have them look outside at the horizon, open air vents for fresh cool air, slow down for smoother flight, avoid turns and fly straight and level, and offer sick bags (I always carry them).<br><br>I'd assess severity - just nauseous or actually vomiting? Can they handle 10-15 more minutes? Decide on landing: if close to destination (10 minutes), continue. If far (30+ minutes) and very sick, divert to nearest airport. If severe medical emergency, declare emergency and land immediately.<br><br>Most cases: a few minutes of fresh air and level flight helps. But if truly in distress, I'm landing.",
                reference: 'AIM 8-1-6',
                link: 'https://www.faa.gov/air_traffic/publications/atpubs/aim_html/chap8_section_1.html'
            },
            {
                question: "You realize you're flying into deteriorating weather. When do you turn around?",
                answer: "The answer: BEFORE it gets bad.<br><br>I turn around when I can't maintain VFR (can't see 3 miles or maintain cloud clearances), when I'm uncomfortable (anxiety or unsure = gut telling me to turn back), when it's getting worse ahead (see a wall of weather building), when I have to descend to stay VFR (scud-running lower = one step from IMC), or when other pilots are turning back (PIREPs of diversions = strong signal).<br><br>The key decision point: turn around while I still have good VMC behind me. Don't wait until I'm trapped.<br><br>Golden rule: better to be on the ground wishing I was in the air, than in the air wishing I was on the ground.",
                reference: 'AC 00-6',
                link: 'https://www.faa.gov/regulations_policies/advisory_circulars/index.cfm/go/document.information/documentID/22625'
            },
            {
                question: "What's get-there-itis and how do you avoid it?",
                answer: '<strong>Get-there-itis</strong> is the dangerous mindset where I push to complete the flight despite warning signs - bad weather, fuel concerns, fatigue, mechanical issues. It clouds judgment, I rationalize bad decisions, take unnecessary risks, and it kills pilots.<br><br><strong>Avoid it:</strong> Remove external pressure (don\'t make commitments I can\'t break, have backup plans like airline tickets), establish personal minimums (decide ahead: "I won\'t fly in less than 5 miles visibility"), have alternates (always have Plan B airport), ask "would I make this decision if nobody was waiting?" (if no, don\'t go), and remember it\'s just a flight - no meeting, event, or person is worth dying for.',
                reference: 'PHAK Chapter 2',
                link: 'https://www.faa.gov/regulations_policies/handbooks_manuals/aviation/phak/media/03_phak_ch2.pdf'
            },
            {
                question: "You land at an airport and can't get the plane to start again. What are your options?",
                answer: "Options: troubleshoot (check fuel selector, mixture, mags, battery dead? try external power, flooded? clear it), call for help (FBO might have mechanic or battery cart), stay overnight (if mechanical, not flying until fixed - secure aircraft, find hotel, get it fixed tomorrow), get a ferry pilot or mechanic (if I can't fix it and can't stay, hire someone to fly it out after repair), or arrange alternate transportation (rental car, airline, friend).<br><br>What I don't do: hand-prop without training/help, or fly with a known mechanical issue.<br><br>Safety first. I'm not flying a broken airplane just to get home.",
                reference: '14 CFR 91.7',
                link: 'https://www.ecfr.gov/current/title-14/chapter-I/subchapter-F/part-91/subpart-A/section-91.7'
            },
            {
                question: 'During cruise, your door pops open. What do you do?',
                answer: "Don't panic - this is not an emergency. The aircraft will fly fine with the door open.<br><br>Fly the airplane and maintain control. Slow down to 80-90 knots or less. Try to close it - many doors can be pulled shut and relatched in flight. Have passenger help if needed.<br><br>If it won't latch, continue to destination if close or land at a nearby airport if it's annoying or unsafe. Secure loose items so nothing flies out.<br><br>Why it's not an emergency: door open doesn't affect flight characteristics significantly. It's loud and uncomfortable, but not dangerous.<br><br>Common mistake: trying to close it immediately and losing control. Fly first, deal with door second.",
                reference: 'POH',
                link: 'https://www.faa.gov/regulations_policies/handbooks_manuals/aviation/'
            },
            {
                question: "You're on downwind and your engine starts running rough. What's your decision process?",
                answer: "Immediate assessment: How rough? Minor roughness (carb ice, fouled plug) is manageable. Severe roughness or power loss is emergency. Can I make the runway? I'm already in the pattern - probably fine, but if power is failing, I might need to land NOW.<br><br>What's the cause? Try carb heat (roughness goes away? carb ice), check mags (one failing?), check mixture (too rich/lean?), check fuel selector (right tank?).<br><br><strong>Minor roughness:</strong> Continue pattern and land normally, troubleshoot gently, don't fly another leg - land and fix it.<br><br><strong>Severe roughness or power loss:</strong> Treat as engine failure, land immediately (straight ahead if on downwind or turn to nearest runway), declare emergency.<br><br>The safe answer: if in the pattern and engine is acting up, I'm landing this lap. Not taking off again.",
                reference: 'POH Emergency Procedures',
                link: 'https://www.faa.gov/regulations_policies/handbooks_manuals/aviation/'
            },
            {
                question: "You're flying VFR at 5,500 feet and ATC says 'Cleared into Class Bravo.' What does this actually mean for you?",
                answer: "<strong>It means I'm allowed to enter Class Bravo airspace</strong>, but I still have to follow all VFR rules. Many pilots think this is like an IFR clearance - it's not.<br><br>I still need to: maintain VFR cloud clearances (clear of clouds), maintain VFR visibility minimums (3 miles), see and avoid other aircraft (ATC isn't separating me from VFR traffic), follow ATC instructions (vectors, altitudes), maintain my assigned altitude unless told otherwise.<br><br><strong>What I'm NOT doing:</strong> Flying IFR, ignoring other traffic, assuming ATC will prevent all conflicts.<br><br><strong>Key point:</strong> 'Cleared' just means 'permission to enter.' I'm still responsible for VFR flight.",
                reference: '14 CFR 91.131',
                link: 'https://www.ecfr.gov/current/title-14/chapter-I/subchapter-F/part-91/subpart-B/subject-group-ECFRe4c59b5f5506932/section-91.131'
            },
            {
                question: "It's a beautiful day - clear skies, 10 miles visibility. You want to practice stalls at 4,000 feet AGL. Legal?",
                answer: "Not necessarily. <strong>Cloud clearance is not the only consideration</strong>. I need to check for airspace restrictions.<br><br><strong>Altitude:</strong> Acrobatic flight (including stalls for practice) requires at least <strong>1,500 feet AGL</strong>. At 4,000 AGL, I'm good.<br><br><strong>Visibility:</strong> Need <strong>3 miles flight visibility</strong>. Got it.<br><br><strong>But the real question:</strong> Am I over a congested area? If I'm over a city, town, or settlement, I can't do acrobatic maneuvers. Period. Even at 10,000 feet.<br><br>Also consider: TFRs, restricted areas, MOAs, proximity to airport traffic patterns.<br><br><strong>Right answer:</strong> Weather is fine, altitude is fine, but I need to be over sparsely populated area and clear of restricted airspace.",
                reference: '14 CFR 91.303',
                link: 'https://www.ecfr.gov/current/title-14/chapter-I/subchapter-F/part-91/subpart-C/section-91.303'
            },
            {
                question: "Your friend who's not a pilot asks to borrow your plane. You let him. He crashes. What happens to you?",
                answer: "<strong>You're in serious trouble.</strong> As the aircraft owner, you're responsible for who flies your aircraft.<br><br><strong>FAA violations:</strong> You allowed an unqualified person to operate an aircraft - that's careless and reckless operation (14 CFR 91.13). You could face certificate action (suspension or revocation). You allowed someone without proper certification to act as PIC (violation of 14 CFR 61.3).<br><br><strong>Civil liability:</strong> You're likely liable for property damage, injuries, deaths. Your insurance probably won't cover it (non-pilot excluded). Lawsuits for damages, potentially millions.<br><br><strong>Criminal charges:</strong> If someone died, potential manslaughter charges depending on circumstances.<br><br><strong>Right answer to friend:</strong> 'No. You need a pilot certificate, current medical, and to be checked out in this specific aircraft. Also, you need to be on my insurance. Here's a flight school instead.'",
                reference: '14 CFR 61.3 & 91.13',
                link: 'https://www.ecfr.gov/current/title-14/chapter-I/subchapter-D/part-61/subpart-A/section-61.3'
            },
            {
                question: "You completed your last flight review 23 months ago. You want to take passengers on a night flight tonight. Are you legal?",
                answer: "<strong>It depends on my night currency.</strong> The flight review being current only addresses my overall pilot-in-command privileges. For night passengers, I need specific night currency.<br><br><strong>Night currency requirement:</strong> To carry passengers at night (1 hour after sunset to 1 hour before sunrise), I need <strong>3 takeoffs and landings to a full stop</strong> within the preceding <strong>90 days</strong> at night.<br><br>If I haven't done 3 night takeoffs and landings in the last 90 days, I cannot take passengers tonight, even though my flight review is current. I can fly solo at night (flight review covers that), but not with passengers.<br><br><strong>Solution:</strong> Do 3 takeoffs and landings to a full stop solo at night, then I'm legal for passengers that same night.",
                reference: '14 CFR 61.57',
                link: 'https://www.ecfr.gov/current/title-14/chapter-I/subchapter-D/part-61/subpart-A/section-61.57'
            }
        ];
        
        // Topic categories for questions (by index)
        const questionTopics = {
            'Pilot Certification & Currency': {
                questions: [0, 2, 3, 4, 5, 8, 9, 28, 32, 33, 43, 52, 69, 72, 93],
                resource: 'https://www.faa.gov/regulations_policies/handbooks_manuals/aviation/phak/',
                description: 'Part 61 regulations, endorsements, currency requirements, and medical certificates'
            },
            'Aircraft Operations & Regulations': {
                questions: [1, 6, 10, 11, 17, 23, 24, 27, 29, 34, 38, 40, 44, 47, 54, 56, 61, 70, 73, 75, 80, 85, 90, 92, 94, 95, 99],
                resource: 'https://www.ecfr.gov/current/title-14/chapter-I/subchapter-F/part-91',
                description: 'Part 91 operating rules, right-of-way, VFR/IFR requirements, and flight operations'
            },
            'Airspace': {
                questions: [12, 13, 16, 18, 25, 39, 45, 49, 57, 63, 67, 78, 84, 96, 97],
                resource: 'https://www.faa.gov/air_traffic/publications/atpubs/aim_html/chap3_section_2.html',
                description: 'Class A/B/C/D/E/G airspace, requirements, and procedures'
            },
            'Weather Theory & Services': {
                questions: [14, 19, 22, 31, 35, 41, 46, 48, 51, 58, 62, 68, 74, 77, 82, 86, 89],
                resource: 'https://www.faa.gov/regulations_policies/handbooks_manuals/aviation/phak/media/14_phak_ch12.pdf',
                description: 'Weather theory, reports, forecasts, and weather-related decision making'
            },
            'Aerodynamics & Flight Theory': {
                questions: [7, 15, 20, 26, 37, 42, 50, 53, 59, 64, 71, 76, 81, 87],
                resource: 'https://www.faa.gov/regulations_policies/handbooks_manuals/aviation/phak/media/06_phak_ch4.pdf',
                description: 'Four forces, stalls, spins, stability, and aerodynamic principles'
            },
            'Aircraft Systems': {
                questions: [21, 30, 36, 55, 60, 65, 79, 83, 88, 91],
                resource: 'https://www.faa.gov/regulations_policies/handbooks_manuals/aviation/phak/media/09_phak_ch7.pdf',
                description: 'Engine, fuel, electrical, and flight instrument systems'
            },
            'Emergency Procedures': {
                questions: [66, 98],
                resource: 'https://www.faa.gov/regulations_policies/handbooks_manuals/aviation/phak/media/17_phak_ch15.pdf',
                description: 'Engine failures, system malfunctions, and emergency decision making'
            },
            'Human Factors & ADM': {
                questions: [8, 9],
                resource: 'https://www.faa.gov/regulations_policies/handbooks_manuals/aviation/phak/media/03_phak_ch2.pdf',
                description: 'Aeronautical Decision Making, hazardous attitudes, and human factors'
            }
        };
        
        // Show app
        function startApp() {
            document.getElementById('landing-screen').classList.add('hidden');
            document.getElementById('app-screen').classList.add('active');
            updateStats();
            
            // Show onboarding on first visit
            const hasSeenOnboarding = localStorage.getItem('ppl-seen-onboarding');
            if (!hasSeenOnboarding) {
                document.getElementById('onboarding-overlay').classList.remove('hidden');
            }
        }
        
        // Close onboarding
        function closeOnboarding() {
            document.getElementById('onboarding-overlay').classList.add('hidden');
            localStorage.setItem('ppl-seen-onboarding', 'true');
        }
        
        // Check if all questions completed
        function checkCompletion() {
            const totalQuestions = questions.length;
            const studiedCount = Object.keys(progress).length;
            
            if (studiedCount === totalQuestions) {
                showCompletionScreen();
            }
        }
        
        // Show completion screen
        function showCompletionScreen() {
            let correct = 0, unsure = 0, wrong = 0;
            
            for (let key in progress) {
                if (progress[key] === 'correct') correct++;
                else if (progress[key] === 'unsure') unsure++;
                else if (progress[key] === 'wrong') wrong++;
            }
            
            const percentage = Math.round((correct / questions.length) * 100);
            
            let message = '';
            if (percentage >= 80) {
                message = "Outstanding! You're showing checkride-ready knowledge. Keep this momentum going!";
            } else if (percentage >= 60) {
                message = "Good progress! Review the questions you missed and you'll be checkride-ready.";
            } else {
                message = "Keep studying! Focus on the questions marked 'Need Practice' to strengthen your weak areas.";
            }
            
            const completionHTML = `
                <div style="text-align: center; padding: 40px 20px;">
                    <div style="font-size: 64px; margin-bottom: 16px;">ðŸŽ‰</div>
                    <h2 style="font-family: 'Montserrat', sans-serif; font-size: 32px; font-weight: 800; color: #1e3a8a; margin-bottom: 16px;">
                        Practice Complete!
                    </h2>
                    <div style="font-size: 72px; font-weight: 800; background: linear-gradient(135deg, #3b82f6 0%, #1e40af 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 16px;">
                        ${percentage}%
                    </div>
                    <p style="color: #64748b; font-size: 18px; line-height: 1.6; max-width: 500px; margin: 0 auto 32px;">
                        ${message}
                    </p>
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; max-width: 400px; margin: 0 auto 32px;">
                        <div style="background: #f0fdf4; padding: 16px; border-radius: 12px; border: 2px solid #bbf7d0;">
                            <div style="font-size: 32px; font-weight: 800; color: #16a34a;">${correct}</div>
                            <div style="font-size: 12px; color: #16a34a; font-weight: 600;">MASTERED</div>
                        </div>
                        <div style="background: #fffbeb; padding: 16px; border-radius: 12px; border: 2px solid #fde68a;">
                            <div style="font-size: 32px; font-weight: 800; color: #d97706;">${unsure}</div>
                            <div style="font-size: 12px; color: #d97706; font-weight: 600;">REVIEW</div>
                        </div>
                        <div style="background: #fef2f2; padding: 16px; border-radius: 12px; border: 2px solid #fecaca;">
                            <div style="font-size: 32px; font-weight: 800; color: #dc2626;">${wrong}</div>
                            <div style="font-size: 12px; color: #dc2626; font-weight: 600;">PRACTICE</div>
                        </div>
                    </div>
                    
                    <div style="background: linear-gradient(135deg, rgba(59,130,246,0.1) 0%, rgba(37,99,235,0.1) 100%); border: 2px solid rgba(59,130,246,0.3); border-radius: 16px; padding: 24px; margin-bottom: 24px;">
                        <div style="font-size: 24px; margin-bottom: 8px;">ðŸ’¡</div>
                        <h3 style="font-size: 20px; font-weight: 700; color: #1e3a8a; margin-bottom: 8px;">What's Next?</h3>
                        <p style="font-size: 14px; color: #64748b; margin-bottom: 16px;">
                            ${wrong > 0 ? 
                                `Focus on the <strong>${wrong} questions</strong> you got wrong. Use <strong>Review Wrong Answers</strong> mode to master them.` : 
                                percentage >= 80 ? 
                                    `You're ready! Take the <strong>Mock Checkride</strong> to test yourself under real exam pressure.` :
                                    `Try <strong>Random Mode</strong> again to test your recall, then review any missed questions.`
                            }
                        </p>
                    </div>
                    
                    <div style="display: flex; gap: 12px; justify-content: center;">
                        <button type="button" onclick="backToModes()" style="padding: 16px 32px; background: rgba(59,130,246,0.1); color: #1e40af; border: 2px solid rgba(59,130,246,0.3); border-radius: 12px; font-size: 16px; font-weight: 700; cursor: pointer; font-family: 'Inter', sans-serif;">
                            â† Back to Modes
                        </button>
                        ${wrong > 0 ? 
                            `<button type="button" onclick="closeCompletion(); startMode('review');" style="padding: 16px 32px; background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); color: white; border: none; border-radius: 12px; font-size: 16px; font-weight: 700; cursor: pointer; font-family: 'Inter', sans-serif; box-shadow: 0 4px 20px rgba(59,130,246,0.3);">
                                Review Wrong Answers â†’
                            </button>` :
                            percentage >= 80 ?
                                `<button type="button" onclick="closeCompletion(); startMockCheckride();" style="padding: 16px 32px; background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); color: white; border: none; border-radius: 12px; font-size: 16px; font-weight: 700; cursor: pointer; font-family: 'Inter', sans-serif; box-shadow: 0 4px 20px rgba(239,68,68,0.3);">
                                    Take Mock Checkride â†’
                                </button>` :
                                `<button type="button" onclick="closeCompletion(); startMode('random');" style="padding: 16px 32px; background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); color: white; border: none; border-radius: 12px; font-size: 16px; font-weight: 700; cursor: pointer; font-family: 'Inter', sans-serif; box-shadow: 0 4px 20px rgba(59,130,246,0.3);">
                                    Try Random Mode â†’
                                </button>`
                        }
                    </div>
                </div>
            `;
            
            // Insert into question card
            const questionCard = document.getElementById('question-card');
            questionCard.innerHTML = completionHTML;
        }
        
        // Close completion screen
        function closeCompletion() {
            backToModes();
        }
        
        // Show upgrade modal
        function showUpgradeModal(feature) {
            const modal = document.getElementById('upgrade-overlay');
            const title = document.getElementById('upgrade-title');
            const subtitle = document.getElementById('upgrade-subtitle');
            
            if (feature === 'mock') {
                title.textContent = 'Mock Checkride Simulator';
                subtitle.textContent = 'Practice under real checkride pressure with timed exams';
            } else if (feature === 'review') {
                title.textContent = 'Review Wrong Answers Mode';
                subtitle.textContent = 'Focus on your weak areas with targeted practice';
            } else if (feature === 'insights') {
                title.textContent = 'Performance Insights';
                subtitle.textContent = 'Get detailed analytics on your study patterns';
            } else if (feature === 'export') {
                title.textContent = 'Export Progress Report';
                subtitle.textContent = 'Download your performance data as PDF';
            }
            
            modal.classList.remove('hidden');
        }
        
        // Close upgrade modal
        function closeUpgradeModal() {
            document.getElementById('upgrade-overlay').classList.add('hidden');
        }
        
        // Upgrade now (redirect to purchase page)
        function upgradeNow() {
            // Replace with your actual Gumroad link
            window.open('https://gumroad.com/pplcheckride', '_blank');
        }
        
        // Mock Checkride Variables
        let mockTimer = null;
        let mockTimeRemaining = 30 * 60; // 30 minutes
        let mockQuestions = [];
        let mockCurrentIndex = 0;
        let mockResults = [];
        
        // Start Mock Checkride (show briefing)
        function startMockCheckride() {
            // Hide mode selection
            document.getElementById('mode-selection').classList.add('hidden');
            document.getElementById('main-reset-container').classList.add('hidden');
            document.getElementById('stats-dashboard').classList.add('hidden');
            
            // Show briefing
            const briefing = document.getElementById('mock-briefing');
            briefing.classList.remove('hidden');
            briefing.classList.add('active');
        }
        
        // Cancel Mock Checkride
        function cancelMockCheckride() {
            const briefing = document.getElementById('mock-briefing');
            briefing.classList.remove('active');
            briefing.classList.add('hidden');
            document.getElementById('mode-selection').classList.remove('hidden');
            document.getElementById('main-reset-container').classList.remove('hidden');
            document.getElementById('stats-dashboard').classList.remove('hidden');
        }
        
        // Exit mock checkride during exam
        function exitMockCheckride() {
            console.log('exitMockCheckride - showing modal');
            // Show custom confirmation modal
            document.getElementById('exit-mock-overlay').classList.remove('hidden');
        }
        
        function closeExitConfirmation() {
            console.log('Exit cancelled');
            document.getElementById('exit-mock-overlay').classList.add('hidden');
        }
        
        function closeNoWrongAnswersModal() {
            console.log('Closing no wrong answers modal');
            document.getElementById('no-wrong-answers-overlay').classList.add('hidden');
        }
        
        function confirmExitMock() {
            console.log('Exit confirmed - proceeding');
            
            // Hide modal
            document.getElementById('exit-mock-overlay').classList.add('hidden');
            
            // Stop timer immediately
            if (window.mockTimer) {
                clearInterval(window.mockTimer);
                window.mockTimer = null;
                console.log('Timer stopped');
            }
            
            // Hide exam screen
            const examScreen = document.getElementById('mock-exam-screen');
            examScreen.classList.remove('active');
            examScreen.classList.add('hidden');
            console.log('Exam screen hidden');
            
            // Show mode selection
            document.getElementById('mode-selection').classList.remove('hidden');
            document.getElementById('main-reset-container').classList.remove('hidden');
            document.getElementById('stats-dashboard').classList.remove('hidden');
            console.log('Mode selection shown');
            
            // Reset exam state
            mockCurrentIndex = 0;
            mockResults = [];
            console.log('Exit complete');
        }
        
        // Begin Mock Checkride (start timer and exam)
        function beginMockCheckride() {
            // Topic-based question selection (30 total)
            // Questions organized by checkride topic flow
            const topicRanges = {
                'Certificates & Documents': { range: [0, 9], count: 4 },
                'Weather': { range: [10, 24], count: 5 },
                'Airspace': { range: [25, 39], count: 4 },
                'Aircraft Systems': { range: [40, 54], count: 5 },
                'Flight Planning': { range: [55, 69], count: 4 },
                'Emergency Procedures': { range: [70, 84], count: 4 },
                'Human Factors & ADM': { range: [85, 92], count: 2 },
                'Regulations & Operations': { range: [93, 99], count: 2 }
            };
            
            // Select random questions from each topic
            mockQuestions = [];
            for (let topic in topicRanges) {
                const { range, count } = topicRanges[topic];
                const [start, end] = range;
                
                // Get all question indices in this range
                const topicQuestions = [];
                for (let i = start; i <= end; i++) {
                    topicQuestions.push(i);
                }
                
                // Shuffle questions within this topic
                for (let i = topicQuestions.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [topicQuestions[i], topicQuestions[j]] = [topicQuestions[j], topicQuestions[i]];
                }
                
                // Take the first 'count' questions from this topic
                mockQuestions.push(...topicQuestions.slice(0, count));
            }
            
            mockCurrentIndex = 0;
            mockResults = [];
            mockTimeRemaining = 30 * 60; // 30 minutes
            
            // Hide briefing, show exam
            const briefing = document.getElementById('mock-briefing');
            briefing.classList.remove('active');
            briefing.classList.add('hidden');
            
            const examScreen = document.getElementById('mock-exam-screen');
            examScreen.classList.remove('hidden');
            examScreen.classList.add('active');
            
            // Start timer
            startMockTimer();
            
            // Load first question
            loadMockQuestion();
        }
        
        // Start timer
        function startMockTimer() {
            mockTimer = setInterval(() => {
                mockTimeRemaining--;
                
                const minutes = Math.floor(mockTimeRemaining / 60);
                const seconds = mockTimeRemaining % 60;
                const display = `${minutes}:${seconds.toString().padStart(2, '0')}`;
                document.getElementById('timer-display').textContent = display;
                
                // Warning colors
                const timerEl = document.getElementById('mock-timer');
                if (mockTimeRemaining <= 300) { // 5 minutes
                    timerEl.style.background = 'rgba(239,68,68,0.25)';
                    timerEl.style.borderColor = 'rgba(239,68,68,0.5)';
                }
                
                // Time's up
                if (mockTimeRemaining <= 0) {
                    clearInterval(mockTimer);
                    endMockCheckride();
                }
            }, 1000);
        }
        
        // Load mock question
        function loadMockQuestion() {
            const qIndex = mockQuestions[mockCurrentIndex];
            const q = questions[qIndex];
            
            document.getElementById('mock-q-num').textContent = `Question ${mockCurrentIndex + 1} of ${mockQuestions.length}`;
            document.getElementById('mock-question-text').textContent = q.question;
            
            // Populate answer (hidden initially)
            document.getElementById('mock-answer-text').innerHTML = q.answer;
            document.getElementById('mock-reference-text').textContent = q.reference;
            document.getElementById('mock-reference-link').href = q.link;
            
            // Reset visibility - hide answer, show thinking space
            document.getElementById('mock-thinking-space').classList.remove('hidden');
            document.getElementById('mock-answer-section').classList.add('hidden');
            
            // Update progress bar
            const progress = ((mockCurrentIndex + 1) / mockQuestions.length) * 100;
            document.getElementById('mock-progress-fill').style.width = progress + '%';
        }
        
        // Reveal answer in mock exam
        function revealMockAnswer() {
            // Hide thinking space/reveal button
            document.getElementById('mock-thinking-space').classList.add('hidden');
            
            // Show answer section with rating buttons
            document.getElementById('mock-answer-section').classList.remove('hidden');
        }
        
        // Rate question in mock exam
        function mockRateQuestion(rating) {
            const qIndex = mockQuestions[mockCurrentIndex];
            mockResults.push({
                questionIndex: qIndex,
                rating: rating
            });
            
            // Move to next question or end
            mockCurrentIndex++;
            if (mockCurrentIndex < mockQuestions.length) {
                loadMockQuestion();
            } else {
                // All questions answered
                clearInterval(mockTimer);
                endMockCheckride();
            }
        }
        
        // End mock checkride and show results
        function endMockCheckride() {
            // Hide exam screen
            const examScreen = document.getElementById('mock-exam-screen');
            examScreen.classList.remove('active');
            examScreen.classList.add('hidden');
            
            // Calculate results
            let correct = 0, unsure = 0, wrong = 0;
            mockResults.forEach(result => {
                if (result.rating === 'correct') correct++;
                else if (result.rating === 'unsure') unsure++;
                else if (result.rating === 'wrong') wrong++;
            });
            
            const percentage = Math.round((correct / mockQuestions.length) * 100);
            const timeUsed = 1800 - mockTimeRemaining;
            const minutesUsed = Math.floor(timeUsed / 60);
            const secondsUsed = timeUsed % 60;
            
            let passFail = '';
            let message = '';
            let scoreColor = '';
            let animationClass = '';
            let containerStyle = '';
            
            if (percentage >= 80) { // 24/30 questions - checkride ready
                passFail = '<div style="font-size: 64px; margin-bottom: 16px;" class="mega-bounce">ðŸŽ‰âœ¨ðŸŽ‰</div><div style="color: #16a34a; font-size: 32px; font-weight: 900; margin-bottom: 16px; text-shadow: 0 0 20px rgba(16, 185, 129, 0.5);" class="epic-celebrate">YOU PASSED!</div>';
                message = "ðŸ”¥ Outstanding performance! You demonstrated checkride-ready knowledge. You'd likely pass the real oral exam! ðŸ”¥";
                scoreColor = 'linear-gradient(135deg, #10b981 0%, #059669 100%)';
                animationClass = 'score-explode';
                containerStyle = 'background: linear-gradient(135deg, rgba(16, 185, 129, 0.05) 0%, rgba(5, 150, 105, 0.05) 100%); border: 3px solid #10b981;';
            } else if (percentage >= 70) { // 21-23/30 questions - needs more work
                passFail = '<div style="font-size: 48px; margin-bottom: 16px;" class="fade-in-slow">âš ï¸</div><div style="color: #d97706; font-size: 28px; font-weight: 800; margin-bottom: 16px;" class="fade-in-slow">MARGINAL</div>';
                message = "You're close, but need more review. Focus on the questions you got wrong before your checkride.";
                scoreColor = 'linear-gradient(135deg, #f59e0b 0%, #d97706 100%)';
                animationClass = 'fade-in-slow';
                containerStyle = '';
            } else { // Below 70% - not ready
                passFail = '<div style="font-size: 48px; margin-bottom: 16px;" class="shake-animation">âŒ</div><div style="color: #dc2626; font-size: 28px; font-weight: 800; margin-bottom: 16px;" class="shake-animation">NOT READY</div>';
                message = "You need more study time. Review the fundamentals and practice more before attempting a checkride.";
                scoreColor = 'linear-gradient(135deg, #ef4444 0%, #dc2626 100%)';
                animationClass = 'shake-animation';
                containerStyle = '';
            }
            
            // Build results HTML
            const resultsHTML = `
                <div style="margin-bottom: 20px;">
                    <button type="button" onclick="backToModesFromMock()" style="padding: 12px 24px; background: rgba(255,255,255,0.1); color: white; border: 1px solid rgba(255,255,255,0.3); border-radius: 10px; font-size: 14px; font-weight: 600; cursor: pointer; font-family: 'Inter', sans-serif; backdrop-filter: blur(10px);">
                        â† Back to Modes
                    </button>
                </div>
                <div style="background: rgba(255,255,255,0.95); border-radius: 20px; padding: 48px; box-shadow: 0 20px 60px rgba(0,0,0,0.3); ${containerStyle}">
                    <h2 style="font-family: 'Montserrat', sans-serif; font-size: 32px; font-weight: 800; color: #1e3a8a; text-align: center; margin-bottom: 24px;">
                        Mock Checkride Complete
                    </h2>
                    
                    ${passFail}
                    
                    <div class="${animationClass}" style="font-size: 96px; font-weight: 900; background: ${scoreColor}; -webkit-background-clip: text; -webkit-text-fill-color: transparent; text-align: center; margin-bottom: 16px; ${percentage >= 80 ? 'text-shadow: 0 0 40px rgba(16, 185, 129, 0.3);' : ''}">
                        ${percentage}%
                    </div>
                    
                    <p style="color: #64748b; font-size: 16px; line-height: 1.6; text-align: center; max-width: 500px; margin: 0 auto 32px;">
                        ${message}
                    </p>
                    
                    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px; margin-bottom: 32px;">
                        <div style="background: #f0fdf4; padding: 20px; border-radius: 12px; border: 2px solid #bbf7d0; text-align: center;">
                            <div style="font-size: 36px; font-weight: 800; color: #16a34a;">${correct}</div>
                            <div style="font-size: 11px; color: #16a34a; font-weight: 600; text-transform: uppercase;">Correct</div>
                        </div>
                        <div style="background: #fffbeb; padding: 20px; border-radius: 12px; border: 2px solid #fde68a; text-align: center;">
                            <div style="font-size: 36px; font-weight: 800; color: #d97706;">${unsure}</div>
                            <div style="font-size: 11px; color: #d97706; font-weight: 600; text-transform: uppercase;">Unsure</div>
                        </div>
                        <div style="background: #fef2f2; padding: 20px; border-radius: 12px; border: 2px solid #fecaca; text-align: center;">
                            <div style="font-size: 36px; font-weight: 800; color: #dc2626;">${wrong}</div>
                            <div style="font-size: 11px; color: #dc2626; font-weight: 600; text-transform: uppercase;">Wrong</div>
                        </div>
                        <div style="background: #f8fafc; padding: 20px; border-radius: 12px; border: 2px solid #cbd5e1; text-align: center;">
                            <div style="font-size: 24px; font-weight: 800; color: #475569;">${minutesUsed}:${secondsUsed.toString().padStart(2, '0')}</div>
                            <div style="font-size: 11px; color: #475569; font-weight: 600; text-transform: uppercase;">Time Used</div>
                        </div>
                    </div>
                    
                    <div style="background: #f8fafc; border-radius: 12px; padding: 24px; margin-bottom: 24px;">
                        <h3 style="font-size: 18px; font-weight: 700; color: #1e293b; margin-bottom: 16px;">ðŸ“‹ Review Your Answers</h3>
                        <div id="mock-review-list"></div>
                    </div>
                    
                    <div style="display: flex; gap: 16px;">
                        <button type="button" onclick="backToModesFromMock()" style="flex: 1; padding: 16px; background: rgba(59,130,246,0.1); color: #1e40af; border: 2px solid rgba(59,130,246,0.3); border-radius: 12px; font-size: 16px; font-weight: 700; cursor: pointer; font-family: 'Inter', sans-serif;">
                            â† Back to Modes
                        </button>
                        <button type="button" onclick="startMockCheckride()" style="flex: 1; padding: 16px; background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); color: white; border: none; border-radius: 12px; font-size: 16px; font-weight: 700; cursor: pointer; font-family: 'Inter', sans-serif; box-shadow: 0 4px 20px rgba(239,68,68,0.3);">
                            Try Again
                        </button>
                    </div>
                </div>
            `;
            
            // Show results
            const resultsEl = document.getElementById('mock-results');
            resultsEl.innerHTML = resultsHTML;
            resultsEl.classList.remove('hidden');
            resultsEl.classList.add('active');
            
            // Build review list
            let reviewHTML = '';
            mockResults.forEach((result, index) => {
                const q = questions[result.questionIndex];
                const statusColor = result.rating === 'correct' ? '#16a34a' : result.rating === 'unsure' ? '#d97706' : '#dc2626';
                const statusBg = result.rating === 'correct' ? '#f0fdf4' : result.rating === 'unsure' ? '#fffbeb' : '#fef2f2';
                const statusIcon = result.rating === 'correct' ? 'âœ…' : result.rating === 'unsure' ? 'âš ï¸' : 'âŒ';
                const statusText = result.rating === 'correct' ? 'Mastered' : result.rating === 'unsure' ? 'Review Needed' : 'Need Practice';
                
                reviewHTML += `
                    <div style="background: ${statusBg}; border: 2px solid ${statusColor}40; border-radius: 12px; padding: 20px; margin-bottom: 16px;">
                        <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 12px; gap: 12px;">
                            <div style="flex: 1;">
                                <div style="color: #64748b; font-size: 12px; font-weight: 600; margin-bottom: 4px;">QUESTION ${index + 1}</div>
                                <strong style="color: #1e293b; font-size: 15px; line-height: 1.5;">${q.question}</strong>
                            </div>
                            <span style="background: ${statusColor}; color: white; padding: 6px 12px; border-radius: 8px; font-weight: 700; font-size: 12px; white-space: nowrap;">${statusIcon} ${statusText}</span>
                        </div>
                        <div style="background: white; border-radius: 8px; padding: 16px; margin-top: 12px;">
                            <div style="color: #0f172a; font-weight: 600; font-size: 11px; text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 8px; color: #059669;">MODEL ANSWER</div>
                            <div style="color: #334155; font-size: 14px; line-height: 1.7;">
                                ${q.answer}
                            </div>
                            <a href="${q.link}" target="_blank" style="display: inline-flex; align-items: center; gap: 6px; margin-top: 12px; padding: 8px 14px; background: #eff6ff; border: 1px solid #93c5fd; border-radius: 8px; color: #1e40af; text-decoration: none; font-size: 13px; font-weight: 600;">
                                ðŸ“– ${q.reference}
                            </a>
                        </div>
                    </div>
                `;
            });
            
            document.getElementById('mock-review-list').innerHTML = reviewHTML;
        }
        
        // Back to modes from mock results
        function backToModesFromMock() {
            const resultsEl = document.getElementById('mock-results');
            resultsEl.classList.remove('active');
            resultsEl.classList.add('hidden');
            document.getElementById('mode-selection').classList.remove('hidden');
            document.getElementById('main-reset-container').classList.remove('hidden');
            document.getElementById('stats-dashboard').classList.remove('hidden');
            
            // Reset mock state
            mockCurrentIndex = 0;
            mockResults = [];
            mockQuestions = [];
        }
        
        // Try again - restart mock checkride
        function tryAgainMockCheckride() {
            // Hide results
            const resultsEl = document.getElementById('mock-results');
            resultsEl.classList.remove('active');
            resultsEl.classList.add('hidden');
            
            // Reset mock state
            mockCurrentIndex = 0;
            mockResults = [];
            mockQuestions = [];
            
            // Show briefing again
            startMockCheckride();
        }
        
        // End session immediately - show results with current progress
        function endSessionNow() {
            // Stop the timer
            clearInterval(mockTimer);
            
            // End the checkride and show results
            endMockCheckride();
        }
        
        // State
        let currentMode = null;
        let currentIndex = 0;
        let questionOrder = [];
        let progress = loadProgress();
        
        // Load progress from localStorage
        function loadProgress() {
            const saved = localStorage.getItem('ppl-progress');
            if (saved) {
                return JSON.parse(saved);
            }
            return {};
        }
        
        // Save progress
        function saveProgress() {
            localStorage.setItem('ppl-progress', JSON.stringify(progress));
            updateStats();
        }
        
        // Update stats display
        function updateStats() {
            let correct = 0, unsure = 0, wrong = 0, studied = 0;
            
            for (let key in progress) {
                studied++;
                if (progress[key] === 'correct') correct++;
                else if (progress[key] === 'unsure') unsure++;
                else if (progress[key] === 'wrong') wrong++;
            }
            
            document.getElementById('stat-correct').textContent = correct;
            document.getElementById('stat-unsure').textContent = unsure;
            document.getElementById('stat-wrong').textContent = wrong;
            document.getElementById('stat-progress').textContent = studied;
            
            // Update progress bar
            const progressPercent = (studied / questions.length) * 100;
            document.getElementById('progress-fill').style.width = progressPercent + '%';
        }
        
        // Start mode
        function startMode(mode) {
            console.log('startMode called with mode:', mode);
            currentMode = mode;
            currentIndex = 0;
            
            // Setup question order
            if (mode === 'review') {
                console.log('Review mode - checking for wrong answers');
                // Only show questions marked as wrong
                questionOrder = [];
                for (let i = 0; i < questions.length; i++) {
                    if (progress[i] === 'wrong') {
                        questionOrder.push(i);
                    }
                }
                
                console.log('Wrong answers found:', questionOrder.length);
                
                // If no wrong answers, show message
                if (questionOrder.length === 0) {
                    console.log('No wrong answers - showing modal');
                    document.getElementById('no-wrong-answers-overlay').classList.remove('hidden');
                    return;
                }
            } else if (mode === 'random') {
                questionOrder = [...Array(questions.length).keys()];
                // Fisher-Yates shuffle
                for (let i = questionOrder.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [questionOrder[i], questionOrder[j]] = [questionOrder[j], questionOrder[i]];
                }
            } else {
                questionOrder = [...Array(questions.length).keys()];
            }
            
            // Show/hide elements
            document.getElementById('mode-selection').classList.add('hidden');
            document.getElementById('main-reset-container').classList.add('hidden');
            document.getElementById('control-bar').classList.remove('hidden');
            document.getElementById('progress-container').classList.remove('hidden');
            document.getElementById('question-card').classList.remove('hidden');
            
            loadQuestion();
        }
        
        // Load question
        function loadQuestion() {
            // Safety check
            if (!questionOrder || questionOrder.length === 0 || currentIndex >= questionOrder.length) {
                console.error('Invalid question order or index');
                return;
            }
            
            const qIndex = questionOrder[currentIndex];
            const q = questions[qIndex];
            
            // Double safety check
            if (!q) {
                console.error('Question not found at index:', qIndex);
                return;
            }
            
            // Save scroll position
            const scrollPosition = window.pageYOffset || document.documentElement.scrollTop;
            
            document.getElementById('q-num').textContent = `Q${qIndex + 1}`;
            document.getElementById('question-text').textContent = q.question;
            document.getElementById('answer-text').innerHTML = q.answer;
            document.getElementById('reference-text').textContent = q.reference;
            document.getElementById('reference-link').href = q.link;
            
            // Hide answer section
            document.getElementById('answer-section').classList.add('hidden');
            document.getElementById('show-answer-btn').classList.remove('hidden');
            
            // Update nav buttons
            document.getElementById('prev-btn').disabled = currentIndex === 0;
            document.getElementById('next-btn').disabled = currentIndex === questionOrder.length - 1;
            
            // Restore scroll position
            window.scrollTo(0, scrollPosition);
        }
        
        // Show answer
        function showAnswer() {
            document.getElementById('answer-section').classList.remove('hidden');
            document.getElementById('show-answer-btn').classList.add('hidden');
        }
        
        // Rate question
        function rateQuestion(rating) {
            const qIndex = questionOrder[currentIndex];
            progress[qIndex] = rating;
            saveProgress();
            
            // Check if all questions are completed
            checkCompletion();
            
            // Auto-advance to next question (only if not completed all)
            if (Object.keys(progress).length < questions.length && currentIndex < questions.length - 1) {
                nextQuestion();
            }
        }
        
        // Navigation
        function nextQuestion() {
            if (currentIndex < questions.length - 1) {
                currentIndex++;
                loadQuestion();
            }
        }
        
        function prevQuestion() {
            if (currentIndex > 0) {
                currentIndex--;
                loadQuestion();
            }
        }
        
        // Back to modes
        function backToModes() {
            document.getElementById('mode-selection').classList.remove('hidden');
            document.getElementById('main-reset-container').classList.remove('hidden');
            document.getElementById('control-bar').classList.add('hidden');
            document.getElementById('progress-container').classList.add('hidden');
            document.getElementById('question-card').classList.add('hidden');
            currentMode = null;
        }
        
        // Reset progress (bulletproof version)
        function resetProgress(event) {
            // Store the button reference for later
            window.resetButtonRef = event;
            // Show confirmation modal
            document.getElementById('reset-confirmation-overlay').classList.remove('hidden');
        }
        
        // Reset progress from main page
        function resetProgressMainPage(event) {
            // Store the button reference for later
            window.resetButtonRef = event;
            // Show confirmation modal
            document.getElementById('reset-confirmation-overlay').classList.remove('hidden');
        }
        
        // Close reset confirmation
        function closeResetConfirmation() {
            document.getElementById('reset-confirmation-overlay').classList.add('hidden');
            window.resetButtonRef = null;
        }
        
        // Confirm reset
        function confirmReset() {
            // Clear everything
            progress = {};
            localStorage.removeItem('ppl-progress');
            updateStats();
            
            // Close modal
            document.getElementById('reset-confirmation-overlay').classList.add('hidden');
            
            // Show feedback on original button if available
            if (window.resetButtonRef && window.resetButtonRef.currentTarget) {
                const btn = window.resetButtonRef.currentTarget;
                const originalText = btn.textContent;
                btn.textContent = 'âœ“ Progress Reset!';
                setTimeout(() => {
                    btn.textContent = originalText;
                }, 2000);
            }
            
            window.resetButtonRef = null;
        }
        
        // Export progress as JSON
        function exportProgress() {
            // Get current progress data
            const exportData = {
                exportDate: new Date().toISOString(),
                appVersion: "1.0",
                totalQuestions: questions.length,
                progress: progress,
                stats: {
                    studied: Object.keys(progress).length,
                    correct: Object.values(progress).filter(p => p === 'correct').length,
                    unsure: Object.values(progress).filter(p => p === 'unsure').length,
                    wrong: Object.values(progress).filter(p => p === 'wrong').length
                }
            };
            
            // Convert to JSON string
            const jsonString = JSON.stringify(exportData, null, 2);
            
            // Create blob and download
            const blob = new Blob([jsonString], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `ppl-oral-exam-progress-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            // Show success message
            showCustomAlert('âœ… Progress Exported!', 'Your progress has been downloaded as a JSON file. You can import this later to restore your progress.');
        }
        
        // Show Performance Insights
        function showPerformanceInsights() {
            // Calculate stats
            let correct = 0, unsure = 0, wrong = 0;
            const studied = Object.keys(progress).length;
            
            for (let key in progress) {
                if (progress[key] === 'correct') correct++;
                else if (progress[key] === 'unsure') unsure++;
                else if (progress[key] === 'wrong') wrong++;
            }
            
            // Calculate percentages
            const totalQuestions = questions.length;
            const studiedPercent = Math.round((studied / totalQuestions) * 100);
            const masteredPercent = studied > 0 ? Math.round((correct / studied) * 100) : 0;
            const readinessScore = studied > 0 ? Math.round(((correct * 1.0 + unsure * 0.5) / studied) * 100) : 0;
            
            // Determine readiness level
            let readinessLevel = '';
            let readinessColor = '';
            let readinessIcon = '';
            let readinessMessage = '';
            
            if (studied === 0) {
                readinessLevel = 'Not Started';
                readinessColor = '#94a3b8';
                readinessIcon = 'ðŸ“š';
                readinessMessage = "You haven't started studying yet. Begin with Study Mode to learn the material, then test yourself with Random Mode or Mock Checkride.";
            } else if (readinessScore >= 80 && studied >= 80) {
                readinessLevel = 'Checkride Ready';
                readinessColor = '#16a34a';
                readinessIcon = 'âœ…';
                readinessMessage = "Excellent! You're demonstrating strong knowledge across the material. You should feel confident going into your checkride. Consider taking a Mock Checkride to simulate exam conditions.";
            } else if (readinessScore >= 70 && studied >= 60) {
                readinessLevel = 'Almost Ready';
                readinessColor = '#d97706';
                readinessIcon = 'âš ï¸';
                readinessMessage = "You're close! Focus on the questions you got wrong or were unsure about. Review those areas and you'll be checkride ready.";
            } else if (studied >= 40) {
                readinessLevel = 'Making Progress';
                readinessColor = '#3b82f6';
                readinessIcon = 'ðŸ“ˆ';
                readinessMessage = "You're building your knowledge. Keep studying and make sure to review questions you get wrong. Aim to master at least 80% of questions before your checkride.";
            } else {
                readinessLevel = 'Just Getting Started';
                readinessColor = '#94a3b8';
                readinessIcon = 'ðŸŽ¯';
                readinessMessage = "Keep going! Study through more questions to get a better assessment of your readiness. Focus on understanding the concepts, not just memorizing answers.";
            }
            
            // Analyze topics by wrong/unsure answers
            const topicAnalysis = {};
            for (let topicName in questionTopics) {
                topicAnalysis[topicName] = {
                    wrong: 0,
                    unsure: 0,
                    correct: 0,
                    total: questionTopics[topicName].questions.length,
                    resource: questionTopics[topicName].resource,
                    description: questionTopics[topicName].description
                };
            }
            
            // Count answers by topic
            for (let qIndex in progress) {
                const rating = progress[qIndex];
                for (let topicName in questionTopics) {
                    if (questionTopics[topicName].questions.includes(parseInt(qIndex))) {
                        if (rating === 'wrong') topicAnalysis[topicName].wrong++;
                        else if (rating === 'unsure') topicAnalysis[topicName].unsure++;
                        else if (rating === 'correct') topicAnalysis[topicName].correct++;
                        break;
                    }
                }
            }
            
            // Sort topics by priority (most wrong answers first)
            const sortedTopics = Object.keys(topicAnalysis).sort((a, b) => {
                const scoreA = topicAnalysis[a].wrong * 2 + topicAnalysis[a].unsure;
                const scoreB = topicAnalysis[b].wrong * 2 + topicAnalysis[b].unsure;
                return scoreB - scoreA;
            });
            
            // Generate topic recommendation (just the top 1)
            let topicRecommendation = '';
            
            for (let topicName of sortedTopics) {
                const topic = topicAnalysis[topicName];
                const problemCount = topic.wrong + topic.unsure;
                
                if (problemCount > 0) {
                    const bgColor = topic.wrong > topic.unsure ? '#fef2f2' : '#fffbeb';
                    const borderColor = topic.wrong > topic.unsure ? '#ef4444' : '#f59e0b';
                    const textColor = topic.wrong > topic.unsure ? '#7f1d1d' : '#78350f';
                    const icon = topic.wrong > topic.unsure ? 'ðŸŽ¯' : 'âš ï¸';
                    
                    // Build the message based on what exists
                    let problemMessage = 'You have ';
                    if (topic.wrong > 0 && topic.unsure > 0) {
                        problemMessage += `<strong>${topic.wrong} wrong</strong> and <strong>${topic.unsure} unsure</strong>`;
                    } else if (topic.wrong > 0) {
                        problemMessage += `<strong>${topic.wrong} wrong</strong>`;
                    } else if (topic.unsure > 0) {
                        problemMessage += `<strong>${topic.unsure} unsure</strong>`;
                    }
                    problemMessage += ` in this area. Study ${topic.description.toLowerCase()}.`;
                    
                    topicRecommendation = `
                        <div style="background: ${bgColor}; border-left: 4px solid ${borderColor}; padding: 24px; border-radius: 8px;">
                            <div style="font-weight: 700; color: ${textColor}; font-size: 16px; margin-bottom: 12px;">
                                ${icon} Focus on: ${topicName}
                            </div>
                            <div style="color: ${textColor}; font-size: 14px; line-height: 1.6; margin-bottom: 16px;">
                                ${problemMessage}
                            </div>
                            <a href="${topic.resource}" target="_blank" style="display: inline-block; padding: 10px 20px; background: ${borderColor}; color: white; text-decoration: none; border-radius: 8px; font-size: 14px; font-weight: 600; transition: all 0.2s;">
                                ðŸ“– Study ${topicName} â†’
                            </a>
                        </div>
                    `;
                    break; // Only show the top 1
                }
            }
            
            // If no problems, show encouragement
            if (topicRecommendation === '') {
                if (studied === totalQuestions) {
                    topicRecommendation = `
                        <div style="background: #f0fdf4; border-left: 4px solid #16a34a; padding: 24px; border-radius: 8px;">
                            <div style="font-weight: 700; color: #166534; font-size: 16px; margin-bottom: 12px;">
                                âœ… Excellent Performance Across All Topics!
                            </div>
                            <div style="color: #166534; font-size: 14px; line-height: 1.6;">
                                You're showing strong knowledge across all subject areas. Take a <strong>Mock Checkride</strong> to test yourself under pressure.
                            </div>
                        </div>
                    `;
                } else {
                    topicRecommendation = `
                        <div style="background: #eff6ff; border-left: 4px solid #3b82f6; padding: 24px; border-radius: 8px;">
                            <div style="font-weight: 700; color: #1e40af; font-size: 16px; margin-bottom: 12px;">
                                ðŸ“š Continue Studying
                            </div>
                            <div style="color: #1e40af; font-size: 14px; line-height: 1.6;">
                                You've completed ${studiedPercent}% (${studied}/${totalQuestions} questions). Continue with <strong>Study Mode</strong> to cover all the material.
                            </div>
                        </div>
                    `;
                }
            }
            
            // Build insights HTML
            const insightsHTML = `
                <div style="max-width: 900px; margin: 0 auto;">
                    <div style="margin-bottom: 20px;">
                        <button type="button" onclick="closeInsights()" style="padding: 12px 24px; background: rgba(255,255,255,0.1); color: white; border: 1px solid rgba(255,255,255,0.3); border-radius: 10px; font-size: 14px; font-weight: 600; cursor: pointer; font-family: 'Inter', sans-serif; backdrop-filter: blur(10px);">
                            â† Back to Modes
                        </button>
                    </div>
                    <div style="background: rgba(255,255,255,0.95); border-radius: 20px; padding: 48px; box-shadow: 0 20px 60px rgba(0,0,0,0.3);">
                    <div style="text-align: center; margin-bottom: 40px;">
                        <h2 style="font-family: 'Montserrat', sans-serif; font-size: 32px; font-weight: 800; color: #1e3a8a; margin-bottom: 8px;">
                            Performance Insights
                        </h2>
                        <p style="color: #64748b; font-size: 16px;">Your detailed study analytics and recommendations</p>
                    </div>
                    
                    <!-- Readiness Score -->
                    <div style="background: linear-gradient(135deg, ${readinessColor}15 0%, ${readinessColor}25 100%); border: 3px solid ${readinessColor}40; border-radius: 16px; padding: 32px; margin-bottom: 32px; text-align: center;">
                        <div style="font-size: 48px; margin-bottom: 12px;">${readinessIcon}</div>
                        <div style="font-size: 24px; font-weight: 800; color: ${readinessColor}; margin-bottom: 8px;">${readinessLevel}</div>
                        <div style="font-size: 48px; font-weight: 800; color: ${readinessColor}; margin-bottom: 16px;">${readinessScore}%</div>
                        <div style="color: #64748b; font-size: 14px; line-height: 1.6; max-width: 600px; margin: 0 auto;">
                            ${readinessMessage}
                        </div>
                    </div>
                    
                    <!-- Progress Overview -->
                    <div style="margin-bottom: 32px;">
                        <h3 style="font-size: 18px; font-weight: 700; color: #1e293b; margin-bottom: 16px;">ðŸ“Š Progress Overview</h3>
                        <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px;">
                            <div style="background: #f8fafc; padding: 20px; border-radius: 12px; text-align: center; border: 2px solid #e2e8f0;">
                                <div style="font-size: 32px; font-weight: 800; color: #3b82f6;">${studied}</div>
                                <div style="font-size: 12px; color: #64748b; font-weight: 600;">QUESTIONS STUDIED</div>
                                <div style="font-size: 11px; color: #94a3b8; margin-top: 4px;">${studiedPercent}% complete</div>
                            </div>
                            <div style="background: #f0fdf4; padding: 20px; border-radius: 12px; text-align: center; border: 2px solid #bbf7d0;">
                                <div style="font-size: 32px; font-weight: 800; color: #16a34a;">${correct}</div>
                                <div style="font-size: 12px; color: #16a34a; font-weight: 600;">MASTERED</div>
                                <div style="font-size: 11px; color: #059669; margin-top: 4px;">${masteredPercent}% of studied</div>
                            </div>
                            <div style="background: #fffbeb; padding: 20px; border-radius: 12px; text-align: center; border: 2px solid #fde68a;">
                                <div style="font-size: 32px; font-weight: 800; color: #d97706;">${unsure}</div>
                                <div style="font-size: 12px; color: #d97706; font-weight: 600;">REVIEW NEEDED</div>
                                <div style="font-size: 11px; color: #b45309; margin-top: 4px;">Need more practice</div>
                            </div>
                            <div style="background: #fef2f2; padding: 20px; border-radius: 12px; text-align: center; border: 2px solid #fecaca;">
                                <div style="font-size: 32px; font-weight: 800; color: #dc2626;">${wrong}</div>
                                <div style="font-size: 12px; color: #dc2626; font-weight: 600;">NEED PRACTICE</div>
                                <div style="font-size: 11px; color: #b91c1c; margin-top: 4px;">Focus here first</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Recommendations -->
                    <div style="margin-bottom: 32px;">
                        <h3 style="font-size: 18px; font-weight: 700; color: #1e293b; margin-bottom: 16px;">ðŸ’¡ Your #1 Priority</h3>
                        ${topicRecommendation}
                    </div>
                    
                    <!-- Study Tips -->
                    <div style="background: #f8fafc; border-radius: 12px; padding: 24px; margin-bottom: 32px;">
                        <h3 style="font-size: 18px; font-weight: 700; color: #1e293b; margin-bottom: 16px;">ðŸ“– Study Tips</h3>
                        <ul style="color: #64748b; font-size: 14px; line-height: 1.8; margin: 0; padding-left: 20px;">
                            <li><strong>Be honest with ratings:</strong> Rating yourself honestly is crucial. If you peeked at the answer before deciding, mark it "Unsure" or "Wrong".</li>
                            <li><strong>Read FAA references:</strong> Click the reference links to read the actual regulations. Understanding the source material helps retention.</li>
                            <li><strong>Practice regularly:</strong> Short, frequent study sessions (15-20 minutes daily) are more effective than cramming.</li>
                            <li><strong>Test yourself:</strong> Use Random Mode or Mock Checkride to test recall, not just recognition.</li>
                            <li><strong>Focus on weak areas:</strong> Spend more time on questions you got wrong rather than reviewing what you already know.</li>
                        </ul>
                    </div>
                </div>
            `;
            
            // Hide mode selection, show insights
            document.getElementById('mode-selection').classList.add('hidden');
            document.getElementById('main-reset-container').classList.add('hidden');
            document.getElementById('stats-dashboard').classList.add('hidden');
            
            const insightsEl = document.getElementById('insights-screen');
            insightsEl.innerHTML = insightsHTML;
            insightsEl.classList.remove('hidden');
            insightsEl.classList.add('active');
        }
        
        // Close insights screen
        function closeInsights() {
            document.getElementById('insights-screen').classList.remove('active');
            document.getElementById('insights-screen').classList.add('hidden');
            document.getElementById('mode-selection').classList.remove('hidden');
            document.getElementById('main-reset-container').classList.remove('hidden');
            document.getElementById('stats-dashboard').classList.remove('hidden');
        }
    </script>
</body>
</html>
